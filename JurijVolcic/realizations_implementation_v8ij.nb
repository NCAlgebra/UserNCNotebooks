(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    195659,       4866]
NotebookOptionsPosition[    192505,       4757]
NotebookOutlinePosition[    192920,       4775]
CellTagsIndexPosition[    192877,       4772]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Author", ":", " ", 
   RowBox[{"Jurij", " ", "Vol\[CHacek]i\[CHacek]"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.6993346181006813`*^9, 3.69933463524967*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Last", " ", 
   RowBox[{"changes", ":", " ", 
    RowBox[{"22", " ", "March", " ", "2017"}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.699334636080213*^9, 3.699334647683628*^9}}],

Cell[CellGroupData[{

Cell["Representations of recognizable series", "Title",
 CellChangeTimes->{{3.6362240905500107`*^9, 3.63622409970903*^9}}],

Cell[" ", "Text",
 Editable->False,
 Selectable->False,
 CellFrame->{{0, 0}, {0, 3}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellFrameColor->RGBColor[0, 0, 1],
 CellSize->{Inherited, 5}],

Cell[CellGroupData[{

Cell["Introduction", "Section",
 CellChangeTimes->{{3.6362241718743677`*^9, 3.6362241794106655`*^9}, {
  3.636306007475813*^9, 3.636306008879975*^9}, {3.636591051668587*^9, 
  3.636591053447147*^9}}],

Cell[CellGroupData[{

Cell["Input and output form", "Subsection",
 CellChangeTimes->{{3.6365910421673346`*^9, 3.636591048205076*^9}}],

Cell[TextData[{
 "We consider the rational expressions over ",
 Cell[BoxData[
  FormBox[
   RowBox[{"z", "[", "1", "]"}], TraditionalForm]]],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{"z", "[", "2", "]"}], TraditionalForm]]],
 ", etc. From the syntax point of view, we write them as in ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 "\[CloseCurlyQuote]s package ",
 StyleBox["NCAlgebra",
  FontSlant->"Italic"],
 ", e.g. \ninv[z[1]**z[2]-z[2]**z[1]]\nrepresents the inverse of a \
commutator. A representation (b, A, c) corresponding to the series ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"b", "(", 
      RowBox[{"I", "-", 
       RowBox[{
        SubscriptBox["\[CapitalSigma]", "i"], "A_i", 
        RowBox[{"(", "x", ")"}]}]}], ")"}], 
     RowBox[{"-", "1"}]], "c"}], TraditionalForm]]],
 " over ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["M", "m"], TraditionalForm]]],
 "(F) is (g+2)-tuple, where g is the number of variables, where b and c are 1\
\[Times]n and n\[Times]1 matrices of m\[Times]m blocks, respectively, and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["A", "i"], TraditionalForm]]],
 " are n\[Times]n matrices of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["m", "2"], "\[Times]", 
    SuperscriptBox["m", "2"]}], TraditionalForm]]],
 " blocks - each representing an element of\n",
 Cell[BoxData[
  FormBox[
   SubscriptBox["M", 
    SuperscriptBox["m", "2"]], TraditionalForm]]],
 "(F) \[Congruent] ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["M", "m"], TraditionalForm]]],
 "(F)\[TensorProduct]",
 Cell[BoxData[
  FormBox[
   SubscriptBox["M", "m"], TraditionalForm]]],
 "(F).\nSimilarly, a symmetric representation (J, A, c) corresponding to the \
series ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["c", "*"], "(", 
      RowBox[{"J", "-", 
       RowBox[{
        SubscriptBox["\[CapitalSigma]", "i"], "A_i", 
        RowBox[{"(", "x", ")"}]}]}], ")"}], 
     RowBox[{"-", "1"}]], "c"}], TraditionalForm]]],
 " over ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["M", "m"], TraditionalForm]]],
 "(F) is (g+2)-tuple as above, where J is a a diagonal n\[Times]n matrix of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"m", "\[Times]", "m"}], TraditionalForm]]],
 " blocks whose nonzero entries are \[PlusMinus]1.\n\nThe functions work best \
with rational arguments (mainly due to the use of build-in function \
Nullspace), are pretty slow with symbolic arguments, e.g. Pi or ",
 Cell[BoxData[
  FormBox[
   SqrtBox["2"], TraditionalForm]]],
 ", and are totally useless with numeric numbers. Therefore the user is \
advised to use just the first ones and the third ones combined with build-in \
function Rationalize. Normally, the output stays in the similar format as the \
input, except in the case of constructing symmetric representation, when the \
output is always numeric.\n\nInstead of 1\[Times]1 matrices, we can just use \
their entries in the input. However, they will be presented as 1\[Times]1 \
matrices in the output. Also, a representation over ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["M", "m"], "(", "F", ")"}], TraditionalForm]]],
 " can be evaluated at a tuple over ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["M", "km"], "(", "F", ")"}], TraditionalForm]]],
 ".\n\nSince our description of representations is a bit unreadable, we use \
special functions just to give a nice depiction of representations."
}], "Text",
 CellChangeTimes->{
  3.636224189849139*^9, 3.6365928045180836`*^9, {3.636644062838971*^9, 
   3.6366441789324894`*^9}, {3.6366442156249247`*^9, 
   3.6366444681056004`*^9}, {3.636644604077408*^9, 3.6366446957591953`*^9}, {
   3.636644829699946*^9, 3.636645050934089*^9}, {3.6366451368906403`*^9, 
   3.6366452654822645`*^9}, {3.636645305184519*^9, 3.6366453233118353`*^9}, {
   3.6366453583353662`*^9, 3.6366454162331553`*^9}, {3.636645516470178*^9, 
   3.6366457574298997`*^9}, {3.6366464750671115`*^9, 3.636646475237183*^9}, {
   3.63664654014736*^9, 3.6366467328637476`*^9}, {3.658776802529153*^9, 
   3.658776804260886*^9}, {3.658776848427883*^9, 3.6587768518133435`*^9}, {
   3.698311638164945*^9, 3.698311639700379*^9}, {3.699205506509224*^9, 
   3.6992055363361874`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["List of main functions", "Subsection",
 CellChangeTimes->{{3.63622419825921*^9, 3.636224200584072*^9}, {
  3.636305993292776*^9, 3.63630600181236*^9}}],

Cell[TextData[{
 "\[FivePointedStar] rDim[r] \
......................................................... dimension of a \
representation\n\[FivePointedStar] RepresentationForm[r] \
................................ yields a nice portrayal of an abstract \
representation r\n\[FivePointedStar] rBuild[rf] \
...................................................... excepts a rational \
expression rf and returns a realization of it about abstract point (",
 Cell[BoxData[
  FormBox[
   SubscriptBox["p", "1"], TraditionalForm]]],
 ",...,",
 Cell[BoxData[
  FormBox[
   SubscriptBox["p", "g"], TraditionalForm]]],
 "), which is assumed to lie in the domain of rf\n\n\[FivePointedStar] \
RepresentationForm1[r] .............................. nice form for \
representations with matrix coefficients\n\[FivePointedStar] rBuild1[rf, p] \
................................................ accepts a rational \
expression rf and a point p in its domain, and returns a realization of rf \
about p\n\[FivePointedStar] Evaluation[r, t] \
............................................ given a representation r and a \
tuple t, returns the evaluation of r at t. If r is a realization of rf about \
p, then Evaluation[r,t-p] equals the evaluation of rf at p.\n\
\[FivePointedStar] ReduceRepresentation1[r] ........................... \
accepts a representation r and returns a reduced representation and the \
dimensions of ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["U", "L"], TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["U", "r"], TraditionalForm]]],
 ".\n\[FivePointedStar] ZeroSeriesQ[r] \
............................................ tests whether r represents the \
zero series\n\[FivePointedStar] rBuild2[rf, p] \
................................................ accepts a rational \
expression rf and a point p in its domain, and returns a minimal realization \
of rf about p (minimization is happening on every step, so this is the most \
efficient way to get minimal realizations)\n\n\[FivePointedStar] ReprH[r] \
.................................................. yields the adjugate \
representation\n\[FivePointedStar] SymRepr[r] \
................................................ if r is a totally reduced \
representation of a Hermitian series, then this function returns its \
symmetric representation (the outcome is upredictable if the assumptions are \
not met)\n\[FivePointedStar] EvaluationS[r, t] \
......................................... evaluation of a symmetric \
representation"
}], "Text",
 CellChangeTimes->{
  3.6362243144730997`*^9, 3.6365928065457196`*^9, {3.6366457738412046`*^9, 
   3.6366458168506804`*^9}, {3.6366458757621264`*^9, 3.636646237571621*^9}, {
   3.6366462736548495`*^9, 3.6366464543774257`*^9}, {3.6366467450649023`*^9, 
   3.6366470830717735`*^9}, {3.636647147503048*^9, 3.636647276318202*^9}, 
   3.6366483518089743`*^9, 3.6366745879434996`*^9, {3.6983094221890607`*^9, 
   3.69830948952893*^9}, {3.699247700238781*^9, 3.6992477030224123`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["NC package", "Subsection",
 CellChangeTimes->{{3.6362242265018215`*^9, 3.6362242291855545`*^9}, 
   3.6365909720702443`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Actually", ",", " ", 
    RowBox[{
    "just", " ", "the", " ", "first", " ", "section", " ", "relies", " ", 
     "on", " ", "this", " ", 
     RowBox[{"package", ".", " ", "Everything"}], " ", "else", " ", "could", 
     " ", "be", " ", "made", " ", "independent", " ", "of", " ", "it", " ", 
     "with", " ", "minor", " ", "corrections"}], ",", " ", 
    RowBox[{
    "so", " ", "it", " ", "might", " ", "be", " ", "possible", " ", "to", " ",
      "rewrite", " ", "most", " ", "of", " ", "it", " ", "in", " ", 
     RowBox[{"Matlab", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"<<", "NC`"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"<<", "NCAlgebra`"}], ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.6362242310735292`*^9, {3.636224429782009*^9, 3.636224432918232*^9}, {
   3.6364092404123335`*^9, 3.6364092450626593`*^9}, {3.6364092972573123`*^9, 
   3.636409356101431*^9}, 3.6365928119891424`*^9, {3.6366427306991167`*^9, 
   3.6366429439212403`*^9}, {3.6366430074682245`*^9, 
   3.6366430478286285`*^9}, {3.6366431570660625`*^9, 3.636643160224378*^9}}],

Cell[" ", "Text",
 Editable->False,
 Selectable->False,
 CellFrame->{{0, 0}, {0, 3}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellFrameColor->RGBColor[0, 0, 1],
 CellSize->{Inherited, 5}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Symbolic representations", "Section",
 CellChangeTimes->{{3.6362243481133833`*^9, 3.6362243525914726`*^9}, {
  3.636244477095436*^9, 3.6362444788427935`*^9}}],

Cell[CellGroupData[{

Cell["Arithmetic operations", "Subsection",
 CellChangeTimes->{{3.6362243642167826`*^9, 3.636224373375802*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "x", ",", " ", "p", ",", " ", "null", ",", " ", "RepresentationForm", ",",
      " ", "rConst", ",", " ", "rX", ",", " ", "rL", ",", " ", "rR", ",", " ",
      "rPlus", ",", " ", "rTimes", ",", " ", "rInverse", ",", " ", "InvCom"}],
     "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"null", "[", 
     RowBox[{"n1_", ",", " ", "n2_"}], "]"}], ":=", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", " ", 
      RowBox[{"{", 
       RowBox[{"n1", ",", " ", "n2"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RepresentationForm", "[", "r_", "]"}], ":=", 
    RowBox[{"TableForm", "[", 
     RowBox[{"{", 
      RowBox[{"MatrixForm", "/@", "r"}], "}"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"representation", " ", "of", " ", "a", " ", "constant"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rConst", "[", 
     RowBox[{"g_", ",", " ", "a_"}], "]"}], ":=", 
    RowBox[{"Append", "[", 
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"null", "[", 
           RowBox[{"1", ",", "1"}], "]"}], ",", "g"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", "a", "}"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", "Id", "}"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "representation", " ", "of", " ", "variable", " ", "shifted", " ", "by", 
    " ", "abstract", " ", "element"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rX", "[", 
     RowBox[{"g_", ",", "i_"}], "]"}], ":=", 
    RowBox[{"Append", "[", 
     RowBox[{
      RowBox[{"Prepend", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Insert", "[", 
         RowBox[{
          RowBox[{"ConstantArray", "[", 
           RowBox[{
            RowBox[{"null", "[", 
             RowBox[{"2", ",", "2"}], "]"}], ",", 
            RowBox[{"g", "-", "1"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "x"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "i"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"Id", ",", 
           RowBox[{"p", "[", "i", "]"}]}], "}"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "0", "}"}], ",", 
        RowBox[{"{", "Id", "}"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"multiplication", " ", "by", " ", "constant"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rL", "[", 
    RowBox[{"r_", ",", "a_"}], "]"}], ":=", 
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{"Rest", "[", "r", "]"}], ",", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "**", "#"}], "&"}], ",", " ", 
       RowBox[{"First", "[", "r", "]"}], ",", " ", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rR", "[", 
     RowBox[{"r_", ",", "a_"}], "]"}], ":=", 
    RowBox[{"Append", "[", 
     RowBox[{
      RowBox[{"Most", "[", "r", "]"}], ",", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "**", "a"}], "&"}], ",", " ", 
        RowBox[{"Last", "[", "r", "]"}], ",", " ", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "addition", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rPlus", "[", 
     RowBox[{"r1_", ",", "r2_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"b1", "=", 
         RowBox[{"First", "[", "r1", "]"}]}], ",", " ", 
        RowBox[{"A1", "=", 
         RowBox[{"Most", "[", 
          RowBox[{"Rest", "[", "r1", "]"}], "]"}]}], ",", " ", 
        RowBox[{"c1", "=", 
         RowBox[{"Last", "[", "r1", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"b2", "=", 
         RowBox[{"First", "[", "r2", "]"}]}], ",", " ", 
        RowBox[{"A2", "=", 
         RowBox[{"Most", "[", 
          RowBox[{"Rest", "[", "r2", "]"}], "]"}]}], ",", " ", 
        RowBox[{"c2", "=", 
         RowBox[{"Last", "[", "r2", "]"}]}], ",", "\[IndentingNewLine]", "n1",
         ",", " ", "n2", ",", " ", "b3", ",", " ", "A3", ",", " ", "c3"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n1", "=", 
        RowBox[{"Length", "[", "c1", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"n2", "=", 
        RowBox[{"Length", "[", "c2", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"b3", "=", 
        RowBox[{"ArrayFlatten", "[", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"b1", ",", " ", "b2"}], "}"}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"c3", "=", 
        RowBox[{"ArrayFlatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "c1", "}"}], ",", 
           RowBox[{"{", "c2", "}"}]}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"A3", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ArrayFlatten", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"A1", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
               RowBox[{"null", "[", 
                RowBox[{"n1", ",", " ", "n2"}], "]"}]}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"null", "[", 
                RowBox[{"n2", ",", " ", "n1"}], "]"}], ",", " ", 
               RowBox[{"A2", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "}"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "A1", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Prepend", "[", 
           RowBox[{"A3", ",", "b3"}], "]"}], ",", "c3"}], "]"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "multiplication", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rTimes", "[", 
     RowBox[{"r1_", ",", "r2_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"b1", "=", 
         RowBox[{"First", "[", "r1", "]"}]}], ",", " ", 
        RowBox[{"A1", "=", 
         RowBox[{"Most", "[", 
          RowBox[{"Rest", "[", "r1", "]"}], "]"}]}], ",", " ", 
        RowBox[{"c1", "=", 
         RowBox[{"Last", "[", "r1", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"b2", "=", 
         RowBox[{"First", "[", "r2", "]"}]}], ",", " ", 
        RowBox[{"A2", "=", 
         RowBox[{"Most", "[", 
          RowBox[{"Rest", "[", "r2", "]"}], "]"}]}], ",", " ", 
        RowBox[{"c2", "=", 
         RowBox[{"Last", "[", "r2", "]"}]}], ",", "\[IndentingNewLine]", "n1",
         ",", "n2", ",", " ", "b3", ",", " ", "A3", ",", " ", "c3"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n1", "=", 
        RowBox[{"Length", "[", "c1", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"n2", "=", 
        RowBox[{"Length", "[", "c2", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"b3", "=", 
        RowBox[{"ArrayFlatten", "[", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"b1", ",", 
            RowBox[{"MatMult", "[", 
             RowBox[{"b1", ",", " ", "c1", ",", " ", "b2"}], "]"}]}], "}"}], 
          "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"A3", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ArrayFlatten", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"A1", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
               RowBox[{"MatMult", "[", 
                RowBox[{
                 RowBox[{"A1", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", " ", "c1", ",", " ", 
                 "b2"}], "]"}]}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"null", "[", 
                RowBox[{"n2", ",", " ", "n1"}], "]"}], ",", " ", 
               RowBox[{"A2", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "}"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "A1", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"c3", "=", 
        RowBox[{"ArrayFlatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"null", "[", 
             RowBox[{"n1", ",", " ", "1"}], "]"}], "}"}], ",", 
           RowBox[{"{", "c2", "}"}]}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Prepend", "[", 
           RowBox[{"A3", ",", "b3"}], "]"}], ",", "c3"}], "]"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "inversion", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rInverse", "[", "r_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"b", "=", 
         RowBox[{"First", "[", "r", "]"}]}], ",", " ", 
        RowBox[{"A", "=", 
         RowBox[{"Most", "[", 
          RowBox[{"Rest", "[", "r", "]"}], "]"}]}], ",", " ", 
        RowBox[{"c", "=", 
         RowBox[{"Last", "[", "r", "]"}]}], ",", "\[IndentingNewLine]", "n", 
        ",", " ", "a", ",", " ", "b0", ",", " ", "cc", ",", " ", "A0", ",", 
        " ", "c0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "c", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"a", "=", 
        RowBox[{
         RowBox[{"MatMult", "[", 
          RowBox[{"b", ",", " ", "c"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"b0", "=", 
        RowBox[{"ArrayFlatten", "[", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"inv", "[", "a", "]"}], "**", "#"}], "&"}], ",", " ", 
              RowBox[{"-", "b"}], ",", " ", 
              RowBox[{"{", "2", "}"}]}], "]"}], ",", " ", 
            RowBox[{"inv", "[", "a", "]"}]}], "}"}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cc", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "**", 
            RowBox[{"inv", "[", "a", "]"}]}], "&"}], ",", " ", "c", ",", " ", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"A0", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ArrayFlatten", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"A", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "-", 
                RowBox[{"MatMult", "[", 
                 RowBox[{
                  RowBox[{"A", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", " ", "cc", ",", " ", 
                  "b"}], "]"}]}], ",", " ", 
               RowBox[{"MatMult", "[", 
                RowBox[{
                 RowBox[{"A", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", " ", "cc"}], "]"}]}], 
              "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"null", "[", 
                RowBox[{"1", ",", " ", "n"}], "]"}], ",", " ", 
               RowBox[{"null", "[", 
                RowBox[{"1", ",", " ", "1"}], "]"}]}], "}"}]}], "}"}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "A", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"c0", "=", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"null", "[", 
           RowBox[{"n", ",", "1"}], "]"}], ",", " ", 
          RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Prepend", "[", 
           RowBox[{"A0", ",", "b0"}], "]"}], ",", "c0"}], "]"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"shifted", " ", "inverse", " ", "of", " ", "commutator"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InvCom", ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s", "=", 
        RowBox[{"inv", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"p", "[", "1", "]"}], "**", 
           RowBox[{"p", "[", "2", "]"}]}], "-", 
          RowBox[{
           RowBox[{"p", "[", "2", "]"}], "**", 
           RowBox[{"p", "[", "1", "]"}]}]}], "]"}]}], ",", " ", "b", ",", " ",
        "Ax1", ",", " ", "Ax2", ",", " ", "c"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"b", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"s", ",", " ", "0", ",", " ", "0"}], "}"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Ax1", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"x", "**", 
              RowBox[{"p", "[", "2", "]"}], "**", "s"}]}], "+", 
            RowBox[{
             RowBox[{"p", "[", "2", "]"}], "**", "x", "**", "s"}]}], ",", " ",
            "x", ",", " ", "0"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0", ",", " ", "0"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"x", "**", "s"}]}], ",", " ", "0", ",", " ", "0"}], 
          "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Ax2", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "**", 
             RowBox[{"p", "[", "1", "]"}], "**", "s"}], "-", 
            RowBox[{
             RowBox[{"p", "[", "1", "]"}], "**", "x", "**", "s"}]}], ",", " ",
            "0", ",", " ", 
           RowBox[{"-", "x"}]}], "}"}], ",", "  ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"x", "**", "s"}]}], ",", " ", "0", ",", " ", "0"}], "}"}],
          ",", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0", ",", " ", "0"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1", "}"}], ",", " ", 
         RowBox[{"{", "0", "}"}], ",", " ", 
         RowBox[{"{", "0", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"b", ",", " ", "Ax1", ",", " ", "Ax2", ",", " ", "c"}], "}"}],
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.636224375560236*^9, 3.636224465247855*^9, 3.6363059782214375`*^9, {
   3.6363189539535685`*^9, 3.6363189632682467`*^9}, {3.636320434266749*^9, 
   3.6363204374805136`*^9}, {3.6363248378791933`*^9, 
   3.6363248410193815`*^9}, {3.636401415656768*^9, 3.6364014157971764`*^9}, {
   3.6364038791694145`*^9, 3.6364038832583694`*^9}, {3.636407429872061*^9, 
   3.6364074299590693`*^9}, {3.6364094910840783`*^9, 
   3.6364095166924086`*^9}, {3.6364095517439137`*^9, 3.63640955210495*^9}, {
   3.6992044239607573`*^9, 3.6992044923804383`*^9}, {3.699247879125737*^9, 
   3.699247885112211*^9}, {3.699247921427205*^9, 3.69924792182395*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Realization about an abstract point", "Subsection",
 CellChangeTimes->{{3.636224383377389*^9, 3.6362244165495796`*^9}, {
  3.636224558040491*^9, 3.636224562237725*^9}, {3.6362395439057455`*^9, 
  3.6362395537396283`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"z", ",", " ", "rDim", ",", " ", "rBuild0", ",", " ", "rBuild"}], 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rDim", "[", "r_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"r", "===", "\"\<Undefined\>\""}], ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{"Last", "[", "r", "]"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "recursive", " ", "transform", " ", "as", " ", "above", " ", "under", " ", 
    "the", " ", "assumption", " ", "that", " ", "everything", " ", "is", " ", 
    "defined"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rBuild0", "[", 
     RowBox[{"g_", ",", " ", "rf_"}], "]"}], ":=", 
    RowBox[{"Which", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FreeQ", "[", 
       RowBox[{"rf", ",", "z"}], "]"}], ",", " ", 
      RowBox[{"rConst", "[", 
       RowBox[{"g", ",", 
        RowBox[{"rf", "**", "Id"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Head", "[", "rf", "]"}], "===", "z"}], ",", " ", 
      RowBox[{"rX", "[", 
       RowBox[{"g", ",", 
        RowBox[{"Last", "[", "rf", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Head", "[", "rf", "]"}], "===", "inv"}], ",", " ", 
      RowBox[{"rInverse", "[", 
       RowBox[{"rBuild0", "[", 
        RowBox[{"g", ",", 
         RowBox[{"First", "[", "rf", "]"}]}], "]"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Head", "[", "rf", "]"}], "===", "Plus"}], ",", " ", 
      RowBox[{"rPlus", "[", 
       RowBox[{
        RowBox[{"rBuild0", "[", 
         RowBox[{"g", ",", 
          RowBox[{"First", "[", "rf", "]"}]}], "]"}], ",", " ", 
        RowBox[{"rBuild0", "[", 
         RowBox[{"g", ",", 
          RowBox[{"Rest", "[", "rf", "]"}]}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Head", "[", "rf", "]"}], "===", "Times"}], ",", " ", 
      RowBox[{"rL", "[", 
       RowBox[{
        RowBox[{"rBuild0", "[", 
         RowBox[{"g", ",", 
          RowBox[{"Rest", "[", "rf", "]"}]}], "]"}], ",", " ", 
        RowBox[{"First", "[", "rf", "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Head", "[", "rf", "]"}], "===", "NonCommutativeMultiply"}], 
      ",", " ", 
      RowBox[{"rTimes", "[", 
       RowBox[{
        RowBox[{"rBuild0", "[", 
         RowBox[{"g", ",", 
          RowBox[{"First", "[", "rf", "]"}]}], "]"}], ",", " ", 
        RowBox[{"rBuild0", "[", 
         RowBox[{"g", ",", 
          RowBox[{"Rest", "[", "rf", "]"}]}], "]"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "same", " ", "as", " ", "above", " ", "but", " ", "without", " ", 
    "specifying", " ", "the", " ", "number", " ", "of", " ", "variables"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rBuild", "[", "rf_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"j", ",", "g"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"g", "=", 
       RowBox[{"StringCases", "[", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"FullForm", "[", "rf", "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<z[\>\"", "~~", 
           RowBox[{"j", ":", "NumberString"}], "~~", "\"\<]\>\""}], "\[Rule]",
           "j"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"g", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"FromDigits", "/@", "g"}], ",", 
         RowBox[{"{", "0", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"rBuild0", "[", 
        RowBox[{"g", ",", "rf"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.6362244191552973`*^9, 3.6362244944890647`*^9, 3.636302466104719*^9, {
   3.6364004014206576`*^9, 3.6364005035441494`*^9}, {3.6364005345909405`*^9, 
   3.636400557227846*^9}, {3.6364022569515367`*^9, 3.6364024482819743`*^9}, {
   3.6364024855369234`*^9, 3.636402538471777*^9}, {3.6364026479165816`*^9, 
   3.636402650028793*^9}, {3.636402816163069*^9, 3.6364028169401464`*^9}, {
   3.6364092811851873`*^9, 3.636409288975733*^9}, {3.636409372752597*^9, 
   3.6364094062349405`*^9}, {3.636414437329465*^9, 3.6364144394356003`*^9}, {
   3.6364908450659633`*^9, 3.6364908624796195`*^9}, {3.636491533475748*^9, 
   3.6364915350559063`*^9}, {3.636498715473278*^9, 3.6364987206945314`*^9}, {
   3.6388180015498123`*^9, 3.6388180022598195`*^9}, {3.6992045229225454`*^9, 
   3.69920452759848*^9}, 3.699204874821911*^9, 3.6992053050439386`*^9, {
   3.699206563234558*^9, 3.699206564185*^9}, {3.699247738103176*^9, 
   3.699247742819702*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Concrete realizations", "Section",
 CellChangeTimes->{{3.6362245365550222`*^9, 3.6362245429522934`*^9}, 
   3.636244470792471*^9}],

Cell[CellGroupData[{

Cell["Tensors, block multiplication", "Subsection",
 CellChangeTimes->{{3.636224649647291*^9, 3.636224660742096*^9}, {
  3.636244516629384*^9, 3.6362445172066355`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "id", ",", " ", "Pairs2Tensor", ",", " ", "Tensor2Pairs", ",", " ", 
     "TensorDotR", ",", " ", "TensorDotRR", ",", " ", "TensorDotL", ",", " ", 
     "TensorDotLL", ",", " ", "BlockMult"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"id", "[", "n_", "]"}], ":=", 
    RowBox[{"IdentityMatrix", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]",
   "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"explicit", " ", "isomorphism", " ", "between", " ", 
    RowBox[{
     SubscriptBox["M", "m"], "\[TensorProduct]", 
     SubscriptBox["M", "m"]}], " ", "and", " ", 
    SubscriptBox["M", 
     SuperscriptBox["m", "2"]], " ", "using", " ", "Kronecker", " ", 
    "product"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Pairs2Tensor", "[", "list_", "]"}], ":=", 
    RowBox[{"Plus", "@@", 
     RowBox[{"KroneckerProduct", "@@@", "list"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "first", " ", "we", " ", "apply", " ", "an", " ", "appropriate", " ", 
     "basis", " ", "change", " ", "on", " ", "matrix"}], ",", " ", 
    RowBox[{
     RowBox[{
     "then", " ", "use", " ", "its", " ", "rank", " ", "decomposition", " ", 
      "to", " ", "find", " ", "the", " ", "tensors"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "a", " ", "pair", " ", "of", " ", "zero", " ", "matrices", " ", "is", 
      " ", "assigned", " ", "to", " ", "the", " ", "zero", " ", 
      "tensor"}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Tensor2Pairs", "[", "mat_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"m", "=", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"Length", "[", "mat", "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", "change", ",", " ", "newmat", ",", " ", 
        "right", ",", " ", "left"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"change", "[", 
         RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"m", " ", 
              RowBox[{"First", "[", "#", "]"}]}], "+", 
             RowBox[{"Last", "[", "#", "]"}], "+", "1"}], ")"}], "&"}], "/@", 
          RowBox[{"(", "\[IndentingNewLine]", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"QuotientRemainder", "[", 
               RowBox[{
                RowBox[{"i", "-", "1"}], ",", "m"}], "]"}], ",", 
              RowBox[{"QuotientRemainder", "[", 
               RowBox[{
                RowBox[{"j", "-", "1"}], ",", "m"}], "]"}]}], "}"}], "]"}], 
           "\[IndentingNewLine]", ")"}]}], "//", "Flatten"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"newmat", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"mat", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{
              RowBox[{"change", "[", 
               RowBox[{"i", ",", "j"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"change", "[", 
               RowBox[{"i", ",", "j"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"m", "^", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"m", "^", "2"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"right", "=", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"RowReduce", "[", "newmat", "]"}], ",", 
          RowBox[{
           RowBox[{"Nand", "@@", 
            RowBox[{"PossibleZeroQ", "[", "#", "]"}]}], "&"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "right", "]"}], "\[Equal]", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"null", "[", 
              RowBox[{"m", ",", "m"}], "]"}], ",", 
             RowBox[{"null", "[", 
              RowBox[{"m", ",", "m"}], "]"}]}], "}"}], "}"}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"left", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"newmat", ".", 
          RowBox[{"ConjugateTranspose", "[", "right", "]"}], ".", 
          RowBox[{"Inverse", "[", 
           RowBox[{"right", ".", 
            RowBox[{"ConjugateTranspose", "[", "right", "]"}]}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Partition", "[", 
             RowBox[{
              RowBox[{"left", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "m"}], "]"}], ",", 
            RowBox[{"Partition", "[", 
             RowBox[{
              RowBox[{"right", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "m"}], "]"}]}], "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "left", "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"given", " ", "A"}], "=", 
     RowBox[{
      RowBox[{
       SubscriptBox["a", "1"], "\[TensorProduct]", 
       SubscriptBox["a", "2"]}], " ", "and", " ", "b", " ", "with", " ", 
      SubscriptBox["a", "2"], " ", "and", " ", "b", " ", "of", " ", "the", 
      " ", "same", " ", "size"}]}], ",", " ", 
    RowBox[{
     RowBox[{"returns", " ", 
      RowBox[{
       SubscriptBox["a", "1"], "\[TensorProduct]", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["a", "2"], "b"}], ")"}]}], " ", "using", " ", 
      "identity", "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["a", "1"], "\[TensorProduct]", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["a", "2"], "b"}], ")"}]}]}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["a", "1"], "\[TensorProduct]", 
        SubscriptBox["a", "2"]}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{"I", "\[TensorProduct]", "b"}], ")"}]}]}], ",", " ", 
    RowBox[{
    "where", " ", "I", " ", "has", " ", "the", " ", "same", " ", "size", " ", 
     "as", " ", 
     SubscriptBox["a", "1"]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TensorDotR", "[", 
     RowBox[{"A_", ",", "b_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"l", "=", 
        RowBox[{
         RowBox[{"Length", "[", "A", "]"}], "/", 
         RowBox[{"Length", "[", "b", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"A", ".", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{
          RowBox[{"id", "[", "l", "]"}], ",", "b"}], "]"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"given", " ", "A"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["a", "1"], "\[TensorProduct]", 
        SubscriptBox["a", "2"]}], " ", "and", " ", "B"}], "=", 
      RowBox[{
       RowBox[{"b", "\[TensorProduct]", "c"}], " ", "with", " ", 
       SubscriptBox["a", "2"]}]}]}], ",", " ", 
    RowBox[{
    "b", " ", "and", " ", "c", " ", "of", " ", "the", " ", "same", " ", 
     "size"}], ",", " ", 
    RowBox[{
     RowBox[{"returns", " ", 
      RowBox[{
       SubscriptBox["a", "1"], "\[TensorProduct]", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["a", "2"], "b"}], ")"}], "\[TensorProduct]", "c"}], " ",
       "using", " ", "identity", "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["a", "1"], "\[TensorProduct]", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["a", "2"], "b"}], ")"}], "\[TensorProduct]", "c"}]}], 
     "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["a", "1"], "\[TensorProduct]", 
          SubscriptBox["a", "2"]}], ")"}], "\[TensorProduct]", "I"}], ")"}], 
      ".", 
      RowBox[{"(", 
       RowBox[{"I", "\[TensorProduct]", 
        RowBox[{"(", 
         RowBox[{"b", "\[TensorProduct]", "c"}], ")"}]}], ")"}]}]}], ",", " ", 
    RowBox[{
    "where", " ", "the", " ", "first", " ", "I", " ", "has", " ", "the", " ", 
     "same", " ", "size", " ", "as", " ", "c", " ", "and", " ", "the", " ", 
     "second", " ", "I", " ", "has", " ", "the", " ", "same", " ", "size", 
     " ", "as", " ", 
     SubscriptBox["a", "1"]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TensorDotRR", "[", 
     RowBox[{"A_", ",", "B_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"l1", "=", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"Length", "[", "B", "]"}], "]"}]}], ",", " ", "l2"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"l2", "=", 
        RowBox[{
         RowBox[{"Length", "[", "A", "]"}], "/", "l1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"A", ",", 
           RowBox[{"id", "[", "l1", "]"}]}], "]"}], ".", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{
           RowBox[{"id", "[", "l2", "]"}], ",", "B"}], "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"left", " ", "variants"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TensorDotL", "[", 
     RowBox[{"b_", ",", "A_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"l", "=", 
        RowBox[{
         RowBox[{"Length", "[", "A", "]"}], "/", 
         RowBox[{"Length", "[", "b", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"b", ",", 
          RowBox[{"id", "[", "l", "]"}]}], "]"}], ".", "A"}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TensorDotLL", "[", 
     RowBox[{"B_", ",", "A_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"l1", "=", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"Length", "[", "B", "]"}], "]"}]}], ",", " ", "l2"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"l2", "=", 
        RowBox[{
         RowBox[{"Length", "[", "A", "]"}], "/", "l1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{"B", ",", 
           RowBox[{"id", "[", "l2", "]"}]}], "]"}], ".", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{
           RowBox[{"id", "[", "l1", "]"}], ",", "A"}], "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"block", "-", 
     RowBox[{"wise", " ", "product"}]}], ";", " ", 
    RowBox[{
    "using", " ", "appropriate", " ", "flag", " ", "it", " ", "can", " ", 
     "be", " ", "applied", " ", "with", " ", "classical", " ", "dot", " ", 
     "product", " ", "or", " ", "with", " ", "any", " ", "of", " ", "the", 
     " ", "previously", " ", "defined", " ", "mixed", " ", "products"}]}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BlockMult", "[", 
    RowBox[{"A_", ",", "B_", ",", "flag_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "Inner", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Inner", "[", 
        RowBox[{"f_", ",", "X_", ",", "Y_"}], "]"}], ":=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"f", "[", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "k"}], "]"}], "]"}], ",", 
             RowBox[{"Y", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "j"}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             RowBox[{"Length", "[", "Y", "]"}]}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "X", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"Y", "//", "Transpose"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"flag", "\[Equal]", "\"\<\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{"Inner", "[", 
         RowBox[{"Dot", ",", "A", ",", "B"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Inner", "[", 
         RowBox[{
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<TensorDot\>\"", "<>", "flag"}], "]"}], ",", "A", ",", 
          "B"}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.6362246821807547`*^9, {3.636227435619632*^9, 3.6362274491707296`*^9}, {
   3.6362274845804596`*^9, 3.6362275804675126`*^9}, {3.636227682484973*^9, 
   3.636227825836335*^9}, {3.63622816754301*^9, 3.6362282444150643`*^9}, {
   3.63622880926979*^9, 3.636228815667733*^9}, {3.636229520828581*^9, 
   3.636229526662981*^9}, 3.6362297719105806`*^9, {3.6362299028657484`*^9, 
   3.636229999953638*^9}, {3.636230048551688*^9, 3.636230074403042*^9}, {
   3.6362301657202144`*^9, 3.636230183163027*^9}, {3.6362304338767085`*^9, 
   3.6362305010104575`*^9}, {3.636230702122238*^9, 3.6362308385011387`*^9}, {
   3.6362309383399773`*^9, 3.636231115472619*^9}, {3.6362311834051623`*^9, 
   3.6362312617359133`*^9}, {3.636231302002462*^9, 3.636231311343927*^9}, 
   3.6362346323823195`*^9, {3.6362437148686695`*^9, 3.636243716693612*^9}, {
   3.6362446520661373`*^9, 3.636244660476292*^9}, {3.6362447054551287`*^9, 
   3.6362447084505973`*^9}, {3.636244920975975*^9, 3.6362449406494665`*^9}, {
   3.636244990184229*^9, 3.6362450491120987`*^9}, {3.63624528069485*^9, 
   3.6362452822551622`*^9}, {3.636245459362295*^9, 3.6362455057974024`*^9}, {
   3.6363013902670527`*^9, 3.6363014542924547`*^9}, {3.6363018612046266`*^9, 
   3.6363018613746333`*^9}, 3.6363018954159946`*^9, {3.6363024332968674`*^9, 
   3.6363025051215696`*^9}, {3.636302539662077*^9, 3.636303358753729*^9}, {
   3.636303417287805*^9, 3.6363036368034406`*^9}, {3.6363037717790537`*^9, 
   3.6363037809194193`*^9}, {3.636304020944916*^9, 3.6363040419587893`*^9}, {
   3.6363040797744017`*^9, 3.6363041760918884`*^9}, {3.6363042085731297`*^9, 
   3.636304235515193*^9}, {3.636305019765004*^9, 3.636305133560842*^9}, {
   3.636305192430676*^9, 3.636305203194441*^9}, {3.6363052582972975`*^9, 
   3.6363052777766643`*^9}, {3.636324787426166*^9, 3.636324808307419*^9}, 
   3.636328770324228*^9, {3.636329724222973*^9, 3.6363297314276934`*^9}, {
   3.6364056393810296`*^9, 3.6364057352586164`*^9}, {3.6364057653046207`*^9, 
   3.636405776660756*^9}, {3.6364058097370634`*^9, 3.6364058946875577`*^9}, {
   3.636406141990286*^9, 3.6364062562817135`*^9}, {3.6364062959726825`*^9, 
   3.636406331960281*^9}, {3.6364068145845385`*^9, 3.636406817246804*^9}, 
   3.6364119982551236`*^9, {3.6364120635765104`*^9, 3.636412092812784*^9}, 
   3.636412767825252*^9, {3.6388180407012043`*^9, 3.6388180415312123`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Arithmetic operations", "Subsection",
 CellChangeTimes->{{3.636224700093202*^9, 3.6362247077855797`*^9}, {
  3.6362273687722983`*^9, 3.6362273876561785`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "null1", ",", " ", "rConst1", ",", " ", "rX1", ",", " ", "rL1", ",", " ", 
     "rR1", ",", " ", "rPlus1", ",", " ", "rTimes1", ",", " ", "rInverse1"}], 
    "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "the", " ", "following", " ", "operations", " ", "show", " ", "some", " ", 
     RowBox[{"flexibility", ":", " ", 
      RowBox[{
      "in", " ", "the", " ", "input", " ", "the", " ", "numbers", " ", "can", 
       " ", "be", " ", "used", " ", "instead", " ", "of", " ", "scalar", " ", 
       "matrices"}]}]}], ",", " ", 
    RowBox[{"and", " ", "as", " ", "for", " ", "the", " ", "output"}], ",", 
    " ", 
    RowBox[{
    "it", " ", "is", " ", "adapted", " ", "for", " ", "treating", " ", 
     "scalar", " ", 
     RowBox[{"case", ".", " ", "However"}]}], ",", " ", 
    RowBox[{
    "they", " ", "should", " ", "be", " ", "used", " ", "consistently"}], ",",
     " ", 
    RowBox[{
     RowBox[{"i", ".", "e", ".", " ", "do"}], " ", "not", " ", "try", " ", 
     "to", " ", "add", " ", "representations", " ", "over", " ", "matrices", 
     " ", "of", " ", "different", " ", "sizes"}]}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"null1", "[", 
     RowBox[{"m_", ",", " ", "n1_", ",", " ", "n2_"}], "]"}], ":=", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{
      RowBox[{"null", "[", 
       RowBox[{"m", ",", " ", "m"}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"n1", ",", " ", "n2"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"representation", " ", "of", " ", "a", " ", "constant"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rConst1", "[", 
     RowBox[{"g_", ",", " ", "a_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"aa", ",", "m"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "a", "]"}], "===", "List"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"m", "=", 
           RowBox[{"Length", "[", "a", "]"}]}], ";", 
          RowBox[{"aa", "=", "a"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"m", "=", "1"}], ";", 
          RowBox[{"aa", "=", 
           RowBox[{"{", 
            RowBox[{"{", "a", "}"}], "}"}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "\[IndentingNewLine]", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Prepend", "[", 
           RowBox[{
            RowBox[{"ConstantArray", "[", 
             RowBox[{
              RowBox[{"null1", "[", 
               RowBox[{
                RowBox[{"m", "^", "2"}], ",", "1", ",", "1"}], "]"}], ",", 
              "g"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", "aa", "}"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"id", "[", "m", "]"}], "}"}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "representation", " ", "of", " ", "variable", " ", "shifted", " ", "by", 
    " ", "a"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rX1", "[", 
     RowBox[{"g_", ",", "i_", ",", " ", "a_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"aa", ",", "m", ",", "mat"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "a", "]"}], "===", "List"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"m", "=", 
           RowBox[{"Length", "[", "a", "]"}]}], ";", 
          RowBox[{"aa", "=", "a"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"m", "=", "1"}], ";", 
          RowBox[{"aa", "=", 
           RowBox[{"{", 
            RowBox[{"{", "a", "}"}], "}"}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mat", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"null", "[", 
             RowBox[{
              RowBox[{"m", "^", "2"}], ",", 
              RowBox[{"m", "^", "2"}]}], "]"}], ",", 
            RowBox[{"id", "[", 
             RowBox[{"m", "^", "2"}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"null", "[", 
             RowBox[{
              RowBox[{"m", "^", "2"}], ",", 
              RowBox[{"m", "^", "2"}]}], "]"}], ",", " ", 
            RowBox[{"null", "[", 
             RowBox[{
              RowBox[{"m", "^", "2"}], ",", 
              RowBox[{"m", "^", "2"}]}], "]"}]}], "}"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "\[IndentingNewLine]", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Prepend", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Insert", "[", 
             RowBox[{
              RowBox[{"ConstantArray", "[", 
               RowBox[{
                RowBox[{"null1", "[", 
                 RowBox[{
                  RowBox[{"m", "^", "2"}], ",", "2", ",", "2"}], "]"}], ",", 
                RowBox[{"g", "-", "1"}]}], "]"}], ",", "mat", ",", "i"}], 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"id", "[", "m", "]"}], ",", "aa"}], "}"}], "}"}]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"null", "[", 
              RowBox[{"m", ",", "m"}], "]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"id", "[", "m", "]"}], "}"}]}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"multiplication", " ", "by", " ", "constant"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rL1", "[", 
    RowBox[{"r_", ",", "a_"}], "]"}], ":=", 
   RowBox[{"Which", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"r", "===", "\"\<Undefined\>\""}], ",", " ", "\"\<Undefined\>\"",
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Head", "[", "a", "]"}], "===", "List"}], ",", " ", 
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{"Rest", "[", "r", "]"}], ",", 
       RowBox[{"BlockMult", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", "a", "}"}], "}"}], ",", 
         RowBox[{"First", "[", "r", "]"}], ",", "\"\<\>\""}], "]"}]}], "]"}], 
     ",", "\[IndentingNewLine]", "True", ",", " ", 
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{"Rest", "[", "r", "]"}], ",", 
       RowBox[{"a", " ", 
        RowBox[{"First", "[", "r", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rR1", "[", 
     RowBox[{"r_", ",", "a_"}], "]"}], ":=", 
    RowBox[{"Which", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "===", "\"\<Undefined\>\""}], ",", " ", 
      "\"\<Undefined\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Head", "[", "a", "]"}], "===", "List"}], ",", " ", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"Most", "[", "r", "]"}], ",", 
        RowBox[{"BlockMult", "[", 
         RowBox[{
          RowBox[{"Last", "[", "r", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", "a", "}"}], "}"}], ",", "\"\<\>\""}], "]"}]}], "]"}], 
      ",", "\[IndentingNewLine]", "True", ",", " ", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"Most", "[", "r", "]"}], ",", 
        RowBox[{"a", " ", 
         RowBox[{"Last", "[", "r", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "addition", " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rPlus1", "[", 
     RowBox[{"r1_", ",", "r2_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"r1", "===", "\"\<Undefined\>\""}], "||", 
       RowBox[{"r2", "===", "\"\<Undefined\>\""}]}], ",", "\"\<Undefined\>\"",
       ",", "\[IndentingNewLine]", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"b1", "=", 
           RowBox[{"First", "[", "r1", "]"}]}], ",", " ", 
          RowBox[{"A1", "=", 
           RowBox[{"Most", "[", 
            RowBox[{"Rest", "[", "r1", "]"}], "]"}]}], ",", " ", 
          RowBox[{"c1", "=", 
           RowBox[{"Last", "[", "r1", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"b2", "=", 
           RowBox[{"First", "[", "r2", "]"}]}], ",", " ", 
          RowBox[{"A2", "=", 
           RowBox[{"Most", "[", 
            RowBox[{"Rest", "[", "r2", "]"}], "]"}]}], ",", " ", 
          RowBox[{"c2", "=", 
           RowBox[{"Last", "[", "r2", "]"}]}], ",", "\[IndentingNewLine]", 
          "n1", ",", " ", "n2", ",", " ", "m", ",", " ", "b3", ",", " ", "A3",
           ",", " ", "c3"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"n1", "=", 
          RowBox[{"Length", "[", "c1", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"n2", "=", 
          RowBox[{"Length", "[", "c2", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"m", " ", "=", " ", 
          RowBox[{"Length", "[", 
           RowBox[{"b1", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"b3", "=", 
          RowBox[{"ArrayFlatten", "[", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"b1", ",", " ", "b2"}], "}"}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"c3", "=", 
          RowBox[{"ArrayFlatten", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "c1", "}"}], ",", 
             RowBox[{"{", "c2", "}"}]}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"A3", "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ArrayFlatten", "[", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"A1", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
                 RowBox[{"null1", "[", 
                  RowBox[{
                   RowBox[{"m", "^", "2"}], ",", "n1", ",", " ", "n2"}], 
                  "]"}]}], "}"}], ",", "\[IndentingNewLine]", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"null1", "[", 
                  RowBox[{
                   RowBox[{"m", "^", "2"}], ",", "n2", ",", " ", "n1"}], 
                  "]"}], ",", " ", 
                 RowBox[{"A2", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], 
              "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "A1", "]"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Prepend", "[", 
             RowBox[{"A3", ",", "b3"}], "]"}], ",", "c3"}], "]"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "multiplication", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rTimes1", "[", 
     RowBox[{"r1_", ",", "r2_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"r1", "===", "\"\<Undefined\>\""}], "||", 
       RowBox[{"r2", "===", "\"\<Undefined\>\""}]}], ",", "\"\<Undefined\>\"",
       ",", "\[IndentingNewLine]", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"b1", "=", 
           RowBox[{"First", "[", "r1", "]"}]}], ",", " ", 
          RowBox[{"A1", "=", 
           RowBox[{"Most", "[", 
            RowBox[{"Rest", "[", "r1", "]"}], "]"}]}], ",", " ", 
          RowBox[{"c1", "=", 
           RowBox[{"Last", "[", "r1", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"b2", "=", 
           RowBox[{"First", "[", "r2", "]"}]}], ",", " ", 
          RowBox[{"A2", "=", 
           RowBox[{"Most", "[", 
            RowBox[{"Rest", "[", "r2", "]"}], "]"}]}], ",", " ", 
          RowBox[{"c2", "=", 
           RowBox[{"Last", "[", "r2", "]"}]}], ",", "\[IndentingNewLine]", 
          "n1", ",", "n2", ",", " ", "m", ",", " ", "mat", ",", " ", "b3", 
          ",", " ", "A3", ",", " ", "c3"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"n1", "=", 
          RowBox[{"Length", "[", "c1", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"n2", "=", 
          RowBox[{"Length", "[", "c2", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"m", " ", "=", " ", 
          RowBox[{"Length", "[", 
           RowBox[{"b1", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"mat", "=", 
          RowBox[{"BlockMult", "[", 
           RowBox[{"c1", ",", "b2", ",", "\"\<\>\""}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"b3", "=", 
          RowBox[{"ArrayFlatten", "[", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"b1", ",", 
              RowBox[{"BlockMult", "[", 
               RowBox[{"b1", ",", "mat", ",", "\"\<\>\""}], "]"}]}], "}"}], 
            "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"A3", "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ArrayFlatten", "[", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"A1", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
                 RowBox[{"BlockMult", "[", 
                  RowBox[{
                   RowBox[{"A1", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", " ", "mat", ",", 
                   " ", "\"\<R\>\""}], "]"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"null1", "[", 
                  RowBox[{
                   RowBox[{"m", "^", "2"}], ",", "n2", ",", " ", "n1"}], 
                  "]"}], ",", " ", 
                 RowBox[{"A2", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], 
              "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "A1", "]"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"c3", "=", 
          RowBox[{"ArrayFlatten", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"null1", "[", 
               RowBox[{"m", ",", "n1", ",", " ", "1"}], "]"}], "}"}], ",", 
             RowBox[{"{", "c2", "}"}]}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Prepend", "[", 
             RowBox[{"A3", ",", "b3"}], "]"}], ",", "c3"}], "]"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "inversion", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rInverse1", "[", "r_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"r", "===", "\"\<Undefined\>\""}], ",", "\"\<Undefined\>\"", ",",
      "\[IndentingNewLine]", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"b", "=", 
          RowBox[{"First", "[", "r", "]"}]}], ",", " ", 
         RowBox[{"A", "=", 
          RowBox[{"Most", "[", 
           RowBox[{"Rest", "[", "r", "]"}], "]"}]}], ",", " ", 
         RowBox[{"c", "=", 
          RowBox[{"Last", "[", "r", "]"}]}], ",", "\[IndentingNewLine]", "n", 
         ",", " ", "a", ",", " ", "m", ",", " ", "b0", ",", " ", "cc", ",", 
         " ", "A0", ",", " ", "c0"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", "c", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"a", "=", 
         RowBox[{
          RowBox[{"BlockMult", "[", 
           RowBox[{"b", ",", " ", "c", ",", "\"\<\>\""}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Det", "[", "a", "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{"Return", "[", "\"\<Undefined\>\"", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"m", "=", 
         RowBox[{"Length", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"b0", "=", 
         RowBox[{"ArrayFlatten", "[", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"BlockMult", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{"-", 
                  RowBox[{"Inverse", "[", "a", "]"}]}], "}"}], "}"}], ",", 
               "b", ",", "\"\<\>\""}], "]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"Inverse", "[", "a", "]"}], "}"}], "}"}]}], "}"}], 
           "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"cc", "=", 
         RowBox[{"BlockMult", "[", 
          RowBox[{"c", ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"Inverse", "[", "a", "]"}], "}"}], "}"}], ",", 
           "\"\<\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"A0", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ArrayFlatten", "[", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"A", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "-", 
                 RowBox[{"BlockMult", "[", 
                  RowBox[{
                   RowBox[{"A", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
                   RowBox[{"BlockMult", "[", 
                    RowBox[{"cc", ",", "b", ",", "\"\<\>\""}], "]"}], ",", 
                   "\"\<R\>\""}], "]"}]}], ",", " ", 
                RowBox[{"BlockMult", "[", 
                 RowBox[{
                  RowBox[{"A", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", " ", "cc", ",", 
                  "\"\<R\>\""}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"null1", "[", 
                 RowBox[{
                  RowBox[{"m", "^", "2"}], ",", "1", ",", " ", "n"}], "]"}], 
                ",", " ", 
                RowBox[{"null1", "[", 
                 RowBox[{
                  RowBox[{"m", "^", "2"}], ",", "1", ",", " ", "1"}], "]"}]}],
                "}"}]}], "\[IndentingNewLine]", "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "A", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"c0", "=", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"null1", "[", 
            RowBox[{"m", ",", "n", ",", "1"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"id", "[", "m", "]"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"Prepend", "[", 
            RowBox[{"A0", ",", "b0"}], "]"}], ",", "c0"}], "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.636224712326111*^9, {3.6363054196920567`*^9, 3.6363055552557497`*^9}, {
   3.6363056600408635`*^9, 3.6363056836022997`*^9}, 3.6363058048910832`*^9, {
   3.6363058424967594`*^9, 3.636305960716218*^9}, {3.63630603267272*^9, 
   3.6363062754809766`*^9}, {3.636306333423462*^9, 3.6363063976375895`*^9}, {
   3.636306465612582*^9, 3.636306486736308*^9}, {3.636306549467527*^9, 
   3.636306594569729*^9}, {3.636306935466995*^9, 3.6363070275445065`*^9}, {
   3.636307068574874*^9, 3.6363071051119823`*^9}, {3.6363072419475985`*^9, 
   3.636307296690806*^9}, {3.636307336831664*^9, 3.636307531795862*^9}, {
   3.6363075667738557`*^9, 3.6363078430962257`*^9}, {3.6363186408629274`*^9, 
   3.6363186754350014`*^9}, {3.63631874571309*^9, 3.6363188662146697`*^9}, {
   3.636318906620742*^9, 3.636318920006228*^9}, {3.6363189854993863`*^9, 
   3.6363190192595177`*^9}, {3.636319056280216*^9, 3.6363190570758567`*^9}, {
   3.63632036467058*^9, 3.6363204089310493`*^9}, {3.6363204701173873`*^9, 
   3.636320470585411*^9}, {3.6363205109758825`*^9, 3.6363205305392857`*^9}, {
   3.6363246658378716`*^9, 3.636324687520172*^9}, {3.636324738273217*^9, 
   3.6363247402333345`*^9}, {3.6363264675658927`*^9, 
   3.6363265626754026`*^9}, {3.6363332394795036`*^9, 
   3.6363332441729727`*^9}, {3.6363333019777527`*^9, 
   3.6363333256571207`*^9}, {3.6364037098025045`*^9, 3.636403715061962*^9}, {
   3.636403747150338*^9, 3.6364037555623493`*^9}, {3.63640389585032*^9, 
   3.6364039031213646`*^9}, {3.636403966704997*^9, 3.636404000719755*^9}, {
   3.6364040309595633`*^9, 3.63640403139645*^9}, {3.6364041482490664`*^9, 
   3.636404150651943*^9}, {3.6364046081579175`*^9, 3.6364046082379255`*^9}, {
   3.6364070286869464`*^9, 3.6364070297900567`*^9}, {3.636407127453822*^9, 
   3.636407240092085*^9}, {3.636407278829958*^9, 3.6364072847535505`*^9}, {
   3.636407503437417*^9, 3.636407544904563*^9}, {3.6364075977658486`*^9, 
   3.636407600667139*^9}, {3.6364076383579073`*^9, 3.6364076406381354`*^9}, {
   3.6364120961045957`*^9, 3.6364121056680083`*^9}, {3.6364987403892565`*^9, 
   3.6364987484611936`*^9}, {3.6364987835606155`*^9, 
   3.6364988020350485`*^9}, {3.636579863432291*^9, 3.636579921580431*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Evaluation and neat output form", "Subsection",
 CellChangeTimes->{{3.636319081803125*^9, 3.6363191665632715`*^9}, {
  3.63631922838054*^9, 3.6363192305007515`*^9}, {3.6363194954405427`*^9, 
  3.636319520354293*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "ZeroMatrixQ", ",", " ", "ScalarMatrixQ", ",", " ", "RepresentationForm1",
      ",", " ", "Evaluation"}], "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"checks", " ", "if", " ", "mat", " ", "is", " ", "zero"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ZeroMatrixQ", "[", "mat_", "]"}], ":=", 
    RowBox[{"And", "@@", 
     RowBox[{"PossibleZeroQ", "/@", 
      RowBox[{"Flatten", "[", "mat", "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "checks", " ", "if", " ", "mat", " ", "is", " ", "a", " ", "scalar", " ",
       "matrix"}], ";", " ", 
     RowBox[{"if", " ", "that", " ", "is", " ", "the", " ", "case"}]}], ",", 
    " ", 
    RowBox[{"it", " ", "returns", " ", "corresponding", " ", "scalar"}]}], 
   " ", "*)"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ScalarMatrixQ", "[", "mat_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"d", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"Diagonal", "[", "mat", "]"}], "]"}]}], ",", " ", 
        RowBox[{"mat0", "=", 
         RowBox[{"mat", "-", 
          RowBox[{"DiagonalMatrix", "[", 
           RowBox[{"Diagonal", "[", "mat", "]"}], "]"}]}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ZeroMatrixQ", "[", "mat0", "]"}], "&&", 
          RowBox[{
           RowBox[{"Length", "[", "d", "]"}], "\[Equal]", "1"}]}], ",", 
         RowBox[{"First", "[", "d", "]"}], ",", "False"}], "]"}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "returns", " ", "relatively", " ", "neat", " ", "depiction", " ", "of", 
    " ", "representation"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RepresentationForm1", "[", "r_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"r", "===", "\"\<Undefined\>\""}], ",", "\"\<Undefined\>\"", 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"b", "=", 
           RowBox[{"First", "[", "r", "]"}]}], ",", " ", 
          RowBox[{"A", "=", 
           RowBox[{"Most", "[", 
            RowBox[{"Rest", "[", "r", "]"}], "]"}]}], ",", " ", 
          RowBox[{"c", "=", 
           RowBox[{"Last", "[", "r", "]"}]}], ",", "\[IndentingNewLine]", 
          "aux1", ",", " ", "aux2", ",", " ", "aux3", ",", " ", "bb", ",", 
          " ", "cc", ",", " ", "AA", ",", " ", "rr"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"aux1", "[", "mat_", "]"}], ":=", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"q", "=", 
              RowBox[{"ScalarMatrixQ", "[", "mat", "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"q", "===", "False"}], ",", 
              RowBox[{"mat", "//", "MatrixForm"}], ",", "q"}], "]"}]}], 
           "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"bb", "=", 
          RowBox[{"Map", "[", 
           RowBox[{"aux1", ",", "b", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"cc", "=", 
          RowBox[{"Map", "[", 
           RowBox[{"aux1", ",", "c", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"aux2", "[", 
           RowBox[{"{", 
            RowBox[{"p1_", ",", "p2_"}], "}"}], "]"}], ":=", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"q1", "=", 
               RowBox[{"aux1", "[", "p1", "]"}]}], ",", " ", 
              RowBox[{"q2", "=", 
               RowBox[{"aux1", "[", "p2", "]"}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Which", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Head", "[", "q1", "]"}], "===", "MatrixForm"}], "&&", 
               RowBox[{
                RowBox[{"Head", "[", "q2", "]"}], "===", "MatrixForm"}]}], 
              ",", " ", 
              RowBox[{
               RowBox[{"aux1", "[", "p1", "]"}], ".", "x", ".", 
               RowBox[{"aux1", "[", "p2", "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Head", "[", "q1", "]"}], " ", "===", "MatrixForm"}], 
              ",", " ", 
              RowBox[{
               RowBox[{"aux1", "[", 
                RowBox[{"p1", " ", "q2"}], "]"}], ".", "x"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Head", "[", "q2", "]"}], " ", "===", "MatrixForm"}], 
              ",", " ", 
              RowBox[{"x", ".", 
               RowBox[{"aux1", "[", 
                RowBox[{"q1", " ", "p2"}], "]"}]}], ",", 
              "\[IndentingNewLine]", "True", ",", " ", 
              RowBox[{"q1", " ", "q2", " ", "x"}]}], "\[IndentingNewLine]", 
             "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"aux3", "[", "mat_", "]"}], ":=", 
          RowBox[{"Total", "[", 
           RowBox[{"aux2", "/@", 
            RowBox[{"Tensor2Pairs", "[", "mat", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AA", "=", 
          RowBox[{"Map", "[", 
           RowBox[{"aux3", ",", "A", ",", 
            RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"rr", "=", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Prepend", "[", 
             RowBox[{"AA", ",", "bb"}], "]"}], ",", "cc"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"TableForm", "[", 
           RowBox[{"{", 
            RowBox[{"MatrixForm", "/@", "rr"}], "}"}], "]"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "evaluation", " ", "of", " ", "representation", " ", "r", " ", "at", " ",
       "a", " ", "tuple", " ", 
      RowBox[{"t", ".", " ", "We"}], " ", "assume", " ", "that", " ", "the", 
      " ", "size", " ", "of", " ", "matrices", " ", "in", " ", "r", " ", 
      "divides", " ", "the", " ", "size", " ", "of", " ", "matrices", " ", 
      "in", " ", "t", " ", "and", " ", "we", " ", "use", " ", "the", " ", 
      "inclusion", " ", "a"}], "\[Rule]", 
     RowBox[{
      RowBox[{
       RowBox[{"I", "\[TensorProduct]", "a"}], ".", " ", "If"}], " ", "r", 
      " ", "is", " ", "a", " ", "realization", " ", "of", " ", "rf", " ", 
      "about", " ", "p"}]}], ",", " ", 
    RowBox[{"then", " ", 
     RowBox[{"Evaluation", "[", 
      RowBox[{"r", ",", 
       RowBox[{"t", "-", "p"}]}], "]"}], " ", "equals", " ", "the", " ", 
     "evaluation", " ", "of", " ", "rf", " ", "at", " ", "t"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Evaluation", "[", 
    RowBox[{"r_", ",", "t_"}], "]"}], ":=", 
   RowBox[{"Which", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"r", "===", "\"\<Undefined\>\""}], ",", " ", "\"\<Undefined\>\"",
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rDim", "[", "r", "]"}], "\[Equal]", "0"}], ",", " ", "0", ",", 
     "\[IndentingNewLine]", "True", ",", " ", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"b", "=", 
          RowBox[{"First", "[", "r", "]"}]}], ",", " ", 
         RowBox[{"A", "=", 
          RowBox[{"Most", "[", 
           RowBox[{"Rest", "[", "r", "]"}], "]"}]}], ",", " ", 
         RowBox[{"c", "=", 
          RowBox[{"Last", "[", "r", "]"}]}], ",", " ", "mm", ",", " ", "tt", 
         ",", " ", "m", ",", " ", "bb", ",", " ", "cc", ",", " ", "aux1", ",",
          " ", "aux2", ",", " ", "L"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", 
            RowBox[{"t", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "===", "List"}], ",", 
          RowBox[{
           RowBox[{"mm", "=", 
            RowBox[{"Length", "[", 
             RowBox[{"t", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
           RowBox[{"tt", "=", "t"}]}], ",", 
          RowBox[{
           RowBox[{"mm", "=", "1"}], ";", 
           RowBox[{"tt", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"{", "#", "}"}], "}"}], "&"}], "/@", "t"}]}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"m", "=", 
         RowBox[{"mm", "/", 
          RowBox[{"Length", "[", 
           RowBox[{"b", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"aux1", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"p1_", ",", "p2_"}], "}"}], ",", "i_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{
            RowBox[{"id", "[", "m", "]"}], ",", "p1"}], "]"}], ".", 
          RowBox[{"tt", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ".", 
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{
            RowBox[{"id", "[", "m", "]"}], ",", "p2"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"aux2", "[", 
          RowBox[{"mat_", ",", "i_"}], "]"}], ":=", 
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"aux1", "[", 
             RowBox[{"#", ",", "i"}], "]"}], "&"}], "/@", 
           RowBox[{"Tensor2Pairs", "[", "mat", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"L", "=", 
         RowBox[{
          RowBox[{"id", "[", 
           RowBox[{"mm", " ", 
            RowBox[{"Length", "[", "c", "]"}]}], "]"}], "-", 
          RowBox[{"ArrayFlatten", "[", 
           RowBox[{"Sum", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"aux2", "[", 
                 RowBox[{"#", ",", "i"}], "]"}], "&"}], ",", 
               RowBox[{"A", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"{", "2", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "A", "]"}]}], "}"}]}], "]"}], "]"}]}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Det", "[", "L", "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{"Return", "[", "\"\<Undefined\>\"", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"bb", "=", 
         RowBox[{"ArrayFlatten", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"KroneckerProduct", "[", 
              RowBox[{
               RowBox[{"id", "[", "m", "]"}], ",", "#"}], "]"}], "&"}], ",", 
            "b", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"cc", "=", 
         RowBox[{"ArrayFlatten", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"KroneckerProduct", "[", 
              RowBox[{
               RowBox[{"id", "[", "m", "]"}], ",", "#"}], "]"}], "&"}], ",", 
            "c", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"bb", ".", 
          RowBox[{"Inverse", "[", "L", "]"}], ".", "cc"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.636319075687611*^9, {3.636319243136015*^9, 3.63631939808222*^9}, {
   3.6363194996389627`*^9, 3.6363195616642103`*^9}, {3.6363200813590517`*^9, 
   3.6363201149319735`*^9}, {3.636320198038435*^9, 3.6363203356998944`*^9}, {
   3.636320541756261*^9, 3.6363205497282696`*^9}, {3.6363205815861034`*^9, 
   3.6363207213692713`*^9}, {3.6363208335400233`*^9, 
   3.6363208453810306`*^9}, {3.636320890061722*^9, 3.6363209946036825`*^9}, {
   3.636321065041295*^9, 3.636321118599841*^9}, {3.6363230947061434`*^9, 
   3.6363231025229254`*^9}, {3.6363237302934475`*^9, 
   3.6363237763018236`*^9}, {3.6363239474517703`*^9, 
   3.6363240881702127`*^9}, {3.6363241470447454`*^9, 3.636324335577057*^9}, {
   3.636324374329382*^9, 3.636324529379684*^9}, {3.636324585893075*^9, 
   3.6363246370561447`*^9}, {3.636324705021222*^9, 3.6363247176819816`*^9}, {
   3.6363252460750914`*^9, 3.636325248615244*^9}, {3.6363252803171463`*^9, 
   3.636325439696708*^9}, {3.6363254815002165`*^9, 3.636325533643345*^9}, {
   3.636325585816475*^9, 3.6363256467901335`*^9}, 3.6363287782650347`*^9, {
   3.636333212061762*^9, 3.6363332141159678`*^9}, {3.6363873965472517`*^9, 
   3.6363876161712675`*^9}, {3.636387889374859*^9, 3.6363879797479763`*^9}, {
   3.636388057422368*^9, 3.636388057593972*^9}, {3.6363881454563074`*^9, 
   3.636388157702935*^9}, {3.636388188530116*^9, 3.6363883195456343`*^9}, {
   3.6363884778937545`*^9, 3.6363884888767176`*^9}, {3.636404381000471*^9, 
   3.6364044313169537`*^9}, {3.6364064862117043`*^9, 3.6364064905621395`*^9}, 
   3.6364065322353063`*^9, {3.636406775357616*^9, 3.6364067761806984`*^9}, {
   3.6364069662837067`*^9, 3.6364069707291512`*^9}, {3.6364121098490763`*^9, 
   3.6364121360129538`*^9}, {3.63641587331691*^9, 3.636415892225322*^9}, {
   3.636415930822196*^9, 3.636415937234207*^9}, {3.636416171437419*^9, 
   3.636416220316352*^9}, {3.636418587965354*^9, 3.636418645018211*^9}, {
   3.636418680073658*^9, 3.63641868291304*^9}, {3.6364191991103287`*^9, 
   3.6364192250703926`*^9}, {3.6364198068536854`*^9, 3.636419894828725*^9}, {
   3.636419951308346*^9, 3.6364199982361536`*^9}, {3.6364200656806774`*^9, 
   3.6364201036223097`*^9}, {3.636420134278675*^9, 3.6364201501292915`*^9}, {
   3.636489774543886*^9, 3.6364898114829645`*^9}, {3.6364898419459963`*^9, 
   3.636489890999139*^9}, {3.6364910999281716`*^9, 3.6364911038587217`*^9}, {
   3.6364988059859962`*^9, 3.6364988132077293`*^9}, {3.6365791462869043`*^9, 
   3.6365791578185186`*^9}, {3.6365792112459974`*^9, 3.636579243881566*^9}, {
   3.636588163850288*^9, 3.636588213556667*^9}, {3.6365883236574526`*^9, 
   3.6365883240318885`*^9}, {3.636588597359643*^9, 3.6365886158718576`*^9}, {
   3.636652238819558*^9, 3.6366522701301847`*^9}, 3.636652348291748*^9, {
   3.636652417153125*^9, 3.63665246188402*^9}, {3.6366525341664653`*^9, 
   3.6366526280883436`*^9}, {3.6366529569159203`*^9, 3.636653038247547*^9}, {
   3.6366530854184904`*^9, 3.6366531259193*^9}, {3.6366531930316424`*^9, 
   3.63665329438367*^9}, {3.6366533507747974`*^9, 3.636653435746497*^9}, {
   3.636653546539713*^9, 3.6366535892505665`*^9}, {3.636653622211226*^9, 
   3.6366536727922373`*^9}, {3.6366537070829234`*^9, 3.636653737563533*^9}, {
   3.6366538043748693`*^9, 3.636653814655075*^9}, {3.636653892017622*^9, 
   3.6366538958876996`*^9}, {3.6366539688591585`*^9, 3.636654050860799*^9}, {
   3.636654097471731*^9, 3.636654293038746*^9}, {3.638818062641423*^9, 
   3.638818063771435*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Realization about a given point", "Subsection",
 CellChangeTimes->{{3.636224723311764*^9, 3.6362247287884874`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "rBuild1", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rBuild1", "[", 
    RowBox[{"rf_", ",", " ", "point_"}], "]"}], ":=", 
   RowBox[{"Which", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FreeQ", "[", 
      RowBox[{"rf", ",", "z"}], "]"}], ",", " ", 
     RowBox[{"rConst1", "[", 
      RowBox[{
       RowBox[{"Length", "[", "point", "]"}], ",", 
       RowBox[{"rf", "*", 
        RowBox[{"id", "[", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"point", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "1"}], "]"}], 
         "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Head", "[", "rf", "]"}], "===", "z"}], ",", " ", 
     RowBox[{"rX1", "[", 
      RowBox[{
       RowBox[{"Length", "[", "point", "]"}], ",", 
       RowBox[{"Last", "[", "rf", "]"}], ",", 
       RowBox[{"point", "[", 
        RowBox[{"[", 
         RowBox[{"Last", "[", "rf", "]"}], "]"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Head", "[", "rf", "]"}], "===", "inv"}], ",", " ", 
     RowBox[{"rInverse1", "[", 
      RowBox[{"rBuild1", "[", 
       RowBox[{
        RowBox[{"First", "[", "rf", "]"}], ",", "point"}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Head", "[", "rf", "]"}], "===", "Plus"}], ",", " ", 
     RowBox[{"rPlus1", "[", 
      RowBox[{
       RowBox[{"rBuild1", "[", 
        RowBox[{
         RowBox[{"First", "[", "rf", "]"}], ",", "point"}], "]"}], ",", " ", 
       RowBox[{"rBuild1", "[", 
        RowBox[{
         RowBox[{"Rest", "[", "rf", "]"}], ",", "point"}], "]"}]}], "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Head", "[", "rf", "]"}], "===", "Times"}], ",", " ", 
     RowBox[{"rL1", "[", 
      RowBox[{
       RowBox[{"rBuild1", "[", 
        RowBox[{
         RowBox[{"Rest", "[", "rf", "]"}], ",", "point"}], "]"}], ",", " ", 
       RowBox[{"First", "[", "rf", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Head", "[", "rf", "]"}], "===", "NonCommutativeMultiply"}], 
     ",", " ", 
     RowBox[{"rTimes1", "[", 
      RowBox[{
       RowBox[{"rBuild1", "[", 
        RowBox[{
         RowBox[{"First", "[", "rf", "]"}], ",", "point"}], "]"}], ",", " ", 
       RowBox[{"rBuild1", "[", 
        RowBox[{
         RowBox[{"Rest", "[", "rf", "]"}], ",", "point"}], "]"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.6362247306764746`*^9, {3.6363256797231092`*^9, 3.636325793059909*^9}, {
   3.6363258266219225`*^9, 3.6363258867365294`*^9}, {3.636327807706894*^9, 
   3.6363278485989823`*^9}, {3.6363287857222176`*^9, 3.636328794489867*^9}, {
   3.636414256076047*^9, 3.6364143045015507`*^9}, {3.636414602435848*^9, 
   3.6364146711582527`*^9}, {3.636416102153378*^9, 3.6364161600174866`*^9}, {
   3.6364162264163427`*^9, 3.636416287182238*^9}, {3.636416317994213*^9, 
   3.636416356576486*^9}, {3.636489759647419*^9, 3.636489760863784*^9}, {
   3.636489834634096*^9, 3.6364898354543095`*^9}, 3.6992054079615183`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Minimization", "Section",
 CellChangeTimes->{{3.6363277815782804`*^9, 3.636327785320655*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "Vector space basis for ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    SuperscriptBox["U", "L"], "\[Infinity]"], TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    SuperscriptBox["U", "R"], "\[Infinity]"], TraditionalForm]]]
}], "Subsection",
 CellChangeTimes->{
  3.6363277558117046`*^9, {3.636328321648282*^9, 3.636328321879306*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{"BasisUL", ",", " ", "BasisUR"}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "returns", " ", "vector", " ", "space", " ", "basis", " ", "of", " ", 
    RowBox[{"U", "^", "L"}], " ", "for", " ", "given", " ", "representation", 
    " ", "r"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BasisUL", "[", "r_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"A", "=", 
         RowBox[{"Most", "[", 
          RowBox[{"Rest", "[", "r", "]"}], "]"}]}], ",", " ", 
        RowBox[{"c", "=", 
         RowBox[{"Last", "[", "r", "]"}]}], ",", " ", "\[IndentingNewLine]", 
        "g", ",", " ", "n", ",", " ", "m", ",", "l", ",", " ", "rhs", ",", 
        "basis", ",", " ", "step", ",", " ", "mat", ",", " ", "null"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "=", 
        RowBox[{"Length", "[", "A", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "c", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[Equal]", "0"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"m", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"c", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"l", "=", 
        RowBox[{"n", "*", 
         RowBox[{"m", "^", "2"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rhs", "=", 
        RowBox[{"{", "c", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"basis", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Partition", "[", 
             RowBox[{
              RowBox[{"SparseArray", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", "j"}], "}"}], "\[Rule]", "1"}], ",", 
                RowBox[{"{", 
                 RowBox[{"m", ",", 
                  RowBox[{"m", " ", "n"}]}], "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"m", ",", "m"}], "}"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i", ",", "m"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"m", " ", "n"}]}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"step", "=", "0"}], ",", 
         RowBox[{"step", "<", 
          RowBox[{"m", " ", "n"}]}], ",", 
         RowBox[{"step", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mat", "=", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"BlockMult", "[", 
                  RowBox[{"u", ",", "#", ",", "\"\<L\>\""}], "]"}], "&"}], "/@",
                 "rhs"}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"u", ",", "basis"}], "}"}]}], "]"}], "//", 
            "Transpose"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"null", "=", 
           RowBox[{"NullSpace", "[", "mat", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"null", "\[Equal]", 
             RowBox[{"{", "}"}]}], ",", " ", 
            RowBox[{"Return", "[", 
             RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "null", "]"}], "\[Equal]", "l"}], ",", 
            " ", 
            RowBox[{"Break", "[", "]"}], ",", " ", 
            RowBox[{"l", "=", 
             RowBox[{"Length", "[", "null", "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"basis", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Inner", "[", 
              RowBox[{"Times", ",", "#", ",", "basis", ",", "Plus"}], "]"}], 
             "&"}], "/@", "null"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"step", "\[Equal]", 
             RowBox[{
              RowBox[{"m", " ", "n"}], "-", "1"}]}], ",", " ", 
            RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"rhs", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"BlockMult", "[", 
                  RowBox[{
                   RowBox[{"A", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "#", ",", 
                   "\"\<LL\>\""}], "]"}], "&"}], "/@", "rhs"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "g"}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "basis", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"right", " ", "version"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BasisUR", "[", "r_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", "=", 
        RowBox[{"Most", "[", 
         RowBox[{"Rest", "[", "r", "]"}], "]"}]}], ",", " ", 
       RowBox[{"b", "=", 
        RowBox[{"First", "[", "r", "]"}]}], ",", " ", "\[IndentingNewLine]", 
       "g", ",", " ", "n", ",", " ", "m", ",", "l", ",", " ", "lhs", ",", 
       "basis", ",", " ", "step", ",", " ", "mat", ",", " ", "null"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"g", "=", 
       RowBox[{"Length", "[", "A", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"b", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", "\[Equal]", "0"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"m", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"b", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"l", "=", 
       RowBox[{"n", "*", 
        RowBox[{"m", "^", "2"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lhs", "=", 
       RowBox[{"{", "b", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"basis", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{"SparseArray", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"i", ",", "j"}], "}"}], "\[Rule]", "1"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"m", " ", "n"}], ",", "m"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"m", ",", "m"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"m", " ", "n"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "m"}], "}"}]}], "]"}], ",", "1"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"step", "=", "0"}], ",", 
        RowBox[{"step", "<", 
         RowBox[{"m", " ", "n"}]}], ",", 
        RowBox[{"step", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mat", "=", 
          RowBox[{
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"BlockMult", "[", 
                 RowBox[{"#", ",", "u", ",", "\"\<R\>\""}], "]"}], "&"}], "/@",
                "lhs"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"u", ",", "basis"}], "}"}]}], "]"}], "//", 
           "Transpose"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"null", "=", 
          RowBox[{"NullSpace", "[", "mat", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"null", "\[Equal]", 
            RowBox[{"{", "}"}]}], ",", " ", 
           RowBox[{"Return", "[", 
            RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "null", "]"}], "\[Equal]", "l"}], ",", " ", 
           RowBox[{"Break", "[", "]"}], ",", " ", 
           RowBox[{"l", "=", 
            RowBox[{"Length", "[", "null", "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"basis", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Inner", "[", 
             RowBox[{"Times", ",", "#", ",", "basis", ",", "Plus"}], "]"}], 
            "&"}], "/@", "null"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"step", "\[Equal]", 
            RowBox[{
             RowBox[{"m", " ", "n"}], "-", "1"}]}], ",", " ", 
           RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"lhs", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"BlockMult", "[", 
                 RowBox[{"#", ",", " ", 
                  RowBox[{"A", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<RR\>\""}], "]"}],
                 "&"}], "/@", "lhs"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "g"}], "}"}]}], "]"}], ",", "1"}], "]"}]}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "basis", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdxU0oQwEAB/DXVtRaLazZkjRtenmzJMKBeU3zdVgtJSWKsHq11Q4va9bU
dpij6ElPScSGUjNz8LWPclrzseeg1Gou0yIphAPvv8Ovn3bSaZuWEAShEeEf
40fkrLpIyy2yI7z3fKu9FI9WtOrxiruqCWcybA9+fQqM4oL1pPTBgNmJlROC
Czdcpz3YSxrncbbctIy/6SCH88XuHexwb4bwgqE/gutm4jE8uNWcxYHhznt8
t65RxsWTNK3CbwpKlRCfSo2VTobkNdhf5qnFj45dHR6xvehxR+M4hW/spy2Y
fWDaMZdqozHDWi24/o/qw9KYdAgXjn02fPEZZbA6F/ZiiUD6sWzNvYgrv/JL
mExzPJ4zhDdwb/wqhLftwQTW+WZT+J0XuhTqIs1TqyZM/O6bsevwvPQ/t0DC
Dw==
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Finding a free vector", "Subsection",
 CellChangeTimes->{{3.636333934167966*^9, 3.6363339387334223`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"following", " ", "idea", " ", "of", " ", "Chistov"}], ",", " ", 
    "Ivanyos", ",", " ", 
    RowBox[{"Karpinski", ":", " ", 
     RowBox[{"Lemma", " ", "8"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", "[", "FreeVec", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"input", ":", " ", 
      RowBox[{
      "vector", " ", "space", " ", "basis", " ", "S", " ", "of", " ", 
       "module", " ", "M"}]}], ",", " ", 
     RowBox[{
      RowBox[{"assuming", " ", "|", "S", "|", 
       RowBox[{"\[GreaterEqual]", 
        SuperscriptBox["m", "2"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"output", ":", " ", 
       RowBox[{"free", " ", "vector", " ", "v"}]}]}]}], "\[IndentingNewLine]",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FreeVec", "[", "S_", "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"omega", "=", 
          RowBox[{"Range", "[", 
           RowBox[{"S", "//", "Length"}], "]"}]}], ",", " ", 
         RowBox[{"v", "=", 
          RowBox[{"0", "*", " ", 
           RowBox[{"First", "[", "S", "]"}]}]}], ",", " ", 
         RowBox[{"m", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"S", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], "]"}]}], ",", 
         " ", "\[IndentingNewLine]", 
         RowBox[{"rk", "=", "0"}], ",", " ", "list", ",", " ", "newv"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"rk", "<", "m"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"list", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"v", "+", 
                 RowBox[{"j", "*", "i"}]}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"j", ",", " ", "omega"}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"i", ",", " ", "S"}], "}"}]}], "]"}], ",", " ", 
              "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"newv", "=", 
            RowBox[{"Select", "[", 
             RowBox[{"list", ",", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"MatrixRank", "[", 
                 RowBox[{"ArrayFlatten", "[", "#", "]"}], "]"}], ">", "rk"}], 
               "&"}], ",", " ", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"newv", "\[Equal]", 
              RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"Break", "[", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"v", "=", 
               RowBox[{"First", "[", "newv", "]"}]}], ";", " ", 
              RowBox[{"rk", "=", 
               RowBox[{"MatrixRank", "[", 
                RowBox[{"ArrayFlatten", "[", "v", "]"}], "]"}]}]}]}], 
            "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "v", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
     ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6363339429528437`*^9, 3.6363339542899776`*^9}, {
  3.636334015029051*^9, 3.636334047275275*^9}, {3.6363341402895756`*^9, 
  3.636334144479995*^9}, {3.6363347314291973`*^9, 3.636334737402795*^9}, {
  3.6364097393701916`*^9, 3.6364097868959436`*^9}, {3.63650068029883*^9, 
  3.636500688186358*^9}, {3.636644527324916*^9, 3.636644530600937*^9}, {
  3.6388161812766094`*^9, 3.6388161862166586`*^9}, {3.638816391759714*^9, 
  3.6388164169599667`*^9}, {3.6388164789505863`*^9, 3.638816510840905*^9}, {
  3.638816587931676*^9, 3.638816605442851*^9}, {3.6388179327591248`*^9, 
  3.638817933589133*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Transition matrices", "Subsection",
 CellChangeTimes->{{3.6363348602360773`*^9, 3.6363348653785915`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "assuming", " ", "block", " ", "column", " ", "col", " ", "has", " ", "m",
      " ", "subcolumns", " ", "and", " ", "rank", " ", "m"}], ",", " ", 
    RowBox[{
    "it", " ", "returns", " ", "permutation", " ", "P", " ", "such", " ", 
     "that", " ", "the", " ", "first", " ", "block", " ", "of", " ", 
     RowBox[{"P", ".", "mat"}], " ", "is", " ", "invertible"}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"PermR", "[", "col_", "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"S", "=", 
          RowBox[{"{", "}"}]}], ",", " ", 
         RowBox[{"mat", "=", 
          RowBox[{"ArrayFlatten", "[", "col", "]"}]}], ",", " ", 
         RowBox[{"mat1", "=", 
          RowBox[{"{", "}"}]}], ",", " ", 
         RowBox[{"mat2", "=", 
          RowBox[{"{", "}"}]}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{"rk1", "=", "0"}], ",", " ", 
         RowBox[{"rk2", "=", "0"}], ",", " ", 
         RowBox[{"ind", "=", "1"}], ",", " ", 
         RowBox[{"m", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"col", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ",", " ", 
         "\[IndentingNewLine]", "l", ",", " ", "row", ",", " ", "perm"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"l", "=", 
         RowBox[{"Length", "[", "mat", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"rk1", "<", "m"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"row", "=", 
            RowBox[{"mat", "[", 
             RowBox[{"[", "ind", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"mat2", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"mat1", ",", " ", "row"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"rk2", "=", 
            RowBox[{"MatrixRank", "[", "mat2", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"rk2", ">", "rk1"}], ",", " ", 
             RowBox[{
              RowBox[{"rk1", "=", "rk2"}], ";", " ", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"mat1", ",", " ", "row"}], "]"}], ";", " ", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"S", ",", "ind"}], "]"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"ind", "++"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"S", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"S", ",", 
           RowBox[{"Complement", "[", 
            RowBox[{
             RowBox[{"Range", "[", "l", "]"}], ",", " ", "S"}], "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"perm", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"UnitVector", "[", 
            RowBox[{"l", ",", " ", 
             RowBox[{"S", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "l"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "perm", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "transition", " ", "matrix", " ", "in", " ", "the", " ", "reduction", 
      " ", "algorithm", " ", "is", " ", "of", " ", "the", " ", "form", " ", 
      RowBox[{"Q", ".", "P"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "where", " ", "P", " ", "is", " ", "as", " ", "above", " ", "and", " ", 
       RowBox[{"P", ".", "mat"}]}], "=", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"A", ";", "A1", ";"}], "..."}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
     "and", " ", "the", " ", "first", " ", "column", " ", "of", " ", "Q", " ", 
      RowBox[{"is", " ", "[", 
       RowBox[{
        RowBox[{"invA", ";", 
         RowBox[{"-", 
          RowBox[{"A1", ".", "invA"}]}], ";"}], "..."}], "]"}], " ", "while", 
      " ", "the", " ", "others", " ", "are", " ", "as", " ", "in", " ", 
      "identity", " ", "matrix"}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TransMatR", "[", "col_", "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mat", "=", 
          RowBox[{"ArrayFlatten", "[", "col", "]"}]}], ",", " ", 
         RowBox[{"m", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"col", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ",", " ", 
         RowBox[{"l", "=", 
          RowBox[{"Length", "[", "col", "]"}]}], ",", " ", 
         "\[IndentingNewLine]", "P", ",", " ", "list1", ",", " ", "A", ",", 
         " ", "list2", ",", " ", "aux", ",", " ", "blockQ", ",", " ", "Q"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"P", "=", 
         RowBox[{"PermR", "[", "col", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"list1", "=", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"P", ".", "mat"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"m", ",", " ", "m"}], "}"}]}], "]"}]}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"A", "=", 
         RowBox[{"Inverse", "[", 
          RowBox[{"list1", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"l", "\[Equal]", "1"}], ",", " ", 
          RowBox[{"Return", "[", "A", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"list2", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", 
             RowBox[{"#", ".", "A"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Rest", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"list1", ",", "1"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"aux", "[", 
          RowBox[{"i_", ",", " ", "j_"}], "]"}], ":=", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"i", "\[Equal]", "1"}], "&&", 
            RowBox[{"j", "\[Equal]", "1"}]}], ",", " ", "A", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"j", "\[Equal]", "1"}], ",", " ", 
           RowBox[{"list2", "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"i", "\[Equal]", "j"}], ",", " ", 
           RowBox[{"id", "[", "m", "]"}], ",", "\[IndentingNewLine]", "True", 
           ",", " ", 
           RowBox[{"null", "[", 
            RowBox[{"m", ",", " ", "m"}], "]"}]}], "\[IndentingNewLine]", 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"blockQ", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"aux", "[", 
            RowBox[{"i", ",", " ", "j"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "l"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"j", ",", " ", "l"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Q", "=", 
         RowBox[{"ArrayFlatten", "[", "blockQ", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"Q", ".", "P"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.6363348675288067`*^9, 3.636388638769204*^9, 3.636388677459188*^9, 
   3.6363889549209785`*^9, {3.636388994890485*^9, 3.6363890058579173`*^9}, {
   3.6363890401798973`*^9, 3.6363892019456296`*^9}, {3.6363892603085966`*^9, 
   3.6363892884370193`*^9}, {3.6363893256763673`*^9, 
   3.6363894009039073`*^9}, {3.6363894310292454`*^9, 
   3.6363894315128727`*^9}, {3.6363937572139487`*^9, 
   3.6363937758168087`*^9}, {3.6363938931335397`*^9, 
   3.6363939402892547`*^9}, {3.636395028884701*^9, 3.636395078027536*^9}, {
   3.636395135033224*^9, 3.6363951351892333`*^9}, {3.6363952009470267`*^9, 
   3.6363952140985856`*^9}, {3.6363952984214497`*^9, 3.636395342228777*^9}, {
   3.636409845551303*^9, 3.636409880143724*^9}, {3.6364099169362993`*^9, 
   3.63640998595113*^9}, {3.63641047195249*^9, 3.6364105576331816`*^9}, {
   3.6364106042031665`*^9, 3.6364106327529964`*^9}, {3.6364107291203737`*^9, 
   3.6364107694333577`*^9}, {3.6364108545690145`*^9, 
   3.6364108674398394`*^9}, {3.636410919937205*^9, 3.636410920358432*^9}, {
   3.636410981671362*^9, 3.636411006976184*^9}, {3.6364110861668596`*^9, 
   3.6364112166078205`*^9}, {3.6364118566282454`*^9, 
   3.6364118645847554`*^9}, {3.636411962824252*^9, 3.636411969127056*^9}, {
   3.636412142144147*^9, 3.6364121422845554`*^9}, {3.636412377345823*^9, 
   3.636412399624051*^9}, {3.6364124526518497`*^9, 3.6364124585490274`*^9}, {
   3.636412509830515*^9, 3.6364125427330236`*^9}, {3.6364125770708246`*^9, 
   3.636412593280264*^9}, {3.636412737294095*^9, 3.6364127449697866`*^9}, {
   3.6364127775134726`*^9, 3.6364128029275017`*^9}, {3.6364128345039263`*^9, 
   3.636412837188298*^9}, {3.636644551146269*^9, 3.6366445609587317`*^9}, 
   3.6388181465522623`*^9, {3.638818198182779*^9, 3.6388182012628098`*^9}, {
   3.63881826632346*^9, 3.6388183080838776`*^9}, {3.6388185288370857`*^9, 
   3.63881852926709*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Reduction algorithm", "Subsection",
 CellChangeTimes->{{3.6363348818612394`*^9, 3.6363348935194054`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "EquivRepr", ",", " ", "ReduceLeft", ",", " ", "ReduceRight", ",", " ", 
     "ReduceRepresentation", ",", " ", "ReduceRepresentation1"}], "]"}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "given", " ", "representation", " ", "r", " ", "and", " ", "flattened", 
     " ", "invertible", " ", "matrix", " ", "U"}], ",", 
    RowBox[{
    "it", " ", "returns", " ", "r", " ", "conjugated", " ", "by", " ", 
     "U"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EquivRepr", "[", 
     RowBox[{"r_", ",", "U_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"r", "===", "\"\<Undefined\>\""}], "||", 
       RowBox[{
        RowBox[{"rDim", "[", "r", "]"}], "\[Equal]", "0"}]}], ",", "r", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"b", "=", 
           RowBox[{"First", "[", "r", "]"}]}], ",", " ", 
          RowBox[{"A", "=", 
           RowBox[{"Most", "[", 
            RowBox[{"Rest", "[", "r", "]"}], "]"}]}], ",", " ", 
          RowBox[{"c", "=", 
           RowBox[{"Last", "[", "r", "]"}]}], ",", " ", "\[IndentingNewLine]",
           "m", ",", " ", "U1", ",", " ", "U2", ",", " ", "aux", ",", " ", 
          "bb", ",", " ", "AA", ",", " ", "cc"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"b", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"U1", "=", 
          RowBox[{"Partition", "[", 
           RowBox[{"U", ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"U2", "=", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"Inverse", "[", "U", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"bb", " ", "=", 
          RowBox[{"BlockMult", "[", 
           RowBox[{"b", ",", " ", "U2", ",", "\"\<\>\""}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"aux", "[", "B_", "]"}], ":=", 
          RowBox[{"BlockMult", "[", 
           RowBox[{
            RowBox[{"BlockMult", "[", 
             RowBox[{"U1", ",", "B", ",", "\"\<L\>\""}], "]"}], ",", "U2", 
            ",", "\"\<R\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AA", "=", 
          RowBox[{"aux", "/@", "A"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"cc", "=", 
          RowBox[{"BlockMult", "[", 
           RowBox[{"U1", ",", " ", "c", ",", "\"\<\>\""}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Prepend", "[", 
             RowBox[{"AA", ",", "bb"}], "]"}], ",", "cc"}], "]"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "returns", " ", "the", " ", "result", " ", "after", " ", "one", " ", 
    "step", " ", "of", " ", "reducing", " ", "the", " ", "left", " ", 
    "side"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ReduceLeft", "[", "r_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"basis", "=", 
         RowBox[{"BasisUL", "[", "r", "]"}]}], ",", " ", 
        RowBox[{"c", "=", 
         RowBox[{"Last", "[", "r", "]"}]}], ",", " ", "\[IndentingNewLine]", 
        "rr", ",", " ", "bb", ",", " ", "AA", ",", " ", "cc", ",", " ", "m", 
        ",", " ", "u", ",", " ", "U"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "c", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{"r", ",", "0"}], "}"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"c", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "basis", "]"}], "<", 
          RowBox[{"m", "^", "2"}]}], ",", " ", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{"r", ",", 
            RowBox[{"Length", "[", "basis", "]"}]}], "}"}], "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"u", "=", 
        RowBox[{"FreeVec", "[", "basis", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"U", "=", 
        RowBox[{
         RowBox[{"TransMatR", "[", 
          RowBox[{"Transpose", "[", 
           RowBox[{"u", ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "1", ",", "4", ",", "3"}], "}"}]}], "]"}], 
          "]"}], "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rr", "=", 
        RowBox[{"EquivRepr", "[", 
         RowBox[{"r", ",", 
          RowBox[{"Inverse", "[", "U", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"bb", "=", 
        RowBox[{"First", "[", "rr", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"AA", "=", 
        RowBox[{"Most", "[", 
         RowBox[{"Rest", "[", "rr", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cc", "=", 
        RowBox[{"Last", "[", "rr", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bb", "=", 
        RowBox[{"Drop", "[", 
         RowBox[{"bb", ",", " ", "0", ",", " ", "1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AA", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{"#", ",", " ", "1", ",", " ", "1"}], "]"}], "&"}], "/@", 
         "AA"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cc", "=", 
        RowBox[{"Drop", "[", 
         RowBox[{"cc", ",", " ", "1", ",", " ", "0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Prepend", "[", 
             RowBox[{"AA", ",", "bb"}], "]"}], ",", "cc"}], "]"}], ",", 
          RowBox[{
           RowBox[{"Length", "[", "basis", "]"}], "-", 
           RowBox[{"m", "^", "2"}]}]}], "}"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "returns", " ", "the", " ", "result", " ", "after", " ", "one", " ", 
    "step", " ", "of", " ", "reducing", " ", "the", " ", "right", " ", 
    "side"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ReduceRight", "[", "r_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"basis", "=", 
         RowBox[{"BasisUR", "[", "r", "]"}]}], ",", "  ", 
        RowBox[{"c", "=", 
         RowBox[{"Last", "[", "r", "]"}]}], ",", " ", "\[IndentingNewLine]", 
        "rr", ",", " ", "bb", ",", " ", "AA", ",", " ", "cc", ",", " ", "m", 
        ",", " ", "u", ",", " ", "U"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "c", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{"r", ",", "0"}], "}"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"c", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "basis", "]"}], "<", 
          RowBox[{"m", "^", "2"}]}], ",", " ", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{"r", ",", 
            RowBox[{"Length", "[", "basis", "]"}]}], "}"}], "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"u", "=", 
        RowBox[{"FreeVec", "[", "basis", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"U", "=", 
        RowBox[{"TransMatR", "[", "u", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rr", "=", 
        RowBox[{"EquivRepr", "[", 
         RowBox[{"r", ",", "U"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bb", "=", 
        RowBox[{"First", "[", "rr", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"AA", "=", 
        RowBox[{"Most", "[", 
         RowBox[{"Rest", "[", "rr", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cc", "=", 
        RowBox[{"Last", "[", "rr", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bb", "=", 
        RowBox[{"Drop", "[", 
         RowBox[{"bb", ",", " ", "0", ",", " ", "1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AA", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{"#", ",", " ", "1", ",", " ", "1"}], "]"}], "&"}], "/@", 
         "AA"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cc", "=", 
        RowBox[{"Drop", "[", 
         RowBox[{"cc", ",", " ", "1", ",", " ", "0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Prepend", "[", 
             RowBox[{"AA", ",", "bb"}], "]"}], ",", "cc"}], "]"}], ",", 
          RowBox[{
           RowBox[{"Length", "[", "basis", "]"}], "-", 
           RowBox[{"m", "^", "2"}]}]}], "}"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "returns", " ", "the", " ", "reduced", " ", "representation", " ", "and", 
    " ", "the", " ", "dimensions", " ", "of", " ", "the", " ", "obstruction", 
    " ", "modules"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ReduceRepresentation", "[", "r_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"r", "===", "\"\<Undefined\>\""}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<Undefined\>\"", ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"d", "=", 
           RowBox[{"rDim", "[", "r", "]"}]}], ",", "  ", "m", ",", " ", "dl", 
          ",", " ", "dr", ",", " ", "r0"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"d", "\[Equal]", "0"}], ",", 
           RowBox[{"Return", "[", 
            RowBox[{"{", 
             RowBox[{"r", ",", "0", ",", "0"}], "}"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"m", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"r", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{"True", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"r0", ",", "dl"}], "}"}], "=", 
             RowBox[{"ReduceLeft", "[", "r", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"While", "[", 
             RowBox[{
              RowBox[{"dl", "\[GreaterEqual]", 
               RowBox[{"m", "^", "2"}]}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"r0", ",", "dl"}], "}"}], "=", 
               RowBox[{"ReduceLeft", "[", "r0", "]"}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"r0", ",", "dr"}], "}"}], "=", 
             RowBox[{"ReduceRight", "[", "r0", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"While", "[", 
             RowBox[{
              RowBox[{"dr", "\[GreaterEqual]", 
               RowBox[{"m", "^", "2"}]}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"r0", ",", "dr"}], "}"}], "=", 
               RowBox[{"ReduceRight", "[", "r0", "]"}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"rDim", "[", "r0", "]"}], "\[Equal]", "d"}], ",", 
              RowBox[{"Break", "[", "]"}], ",", 
              RowBox[{"d", "=", 
               RowBox[{"rDim", "[", "r0", "]"}]}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{"r0", ",", "dl", ",", "dr"}], "}"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "just", " ", "one", " ", "left", " ", "cycle", " ", "and", " ", "one", 
     " ", "right", " ", "cycle", " ", "of", " ", "reduction"}], ";", " ", 
    RowBox[{
    "recommended", " ", "for", " ", "a", " ", "representation", " ", 
     "arising", " ", "from", " ", "the", " ", "standard", " ", "construction",
      " ", "applied", " ", "to", " ", "rational", " ", "function"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReduceRepresentation1", "[", "r_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"r", "===", "\"\<Undefined\>\""}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<Undefined\>\"", ",", 
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m", ",", " ", "dl", ",", " ", "dr", ",", " ", "r0"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"rDim", "[", "r", "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", 
            RowBox[{"r", ",", "0", ",", "0"}], "}"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"m", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"r", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"r0", ",", "dl"}], "}"}], "=", 
         RowBox[{"ReduceLeft", "[", "r", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"dl", "\[GreaterEqual]", 
           RowBox[{"m", "^", "2"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"r0", ",", "dl"}], "}"}], "=", 
           RowBox[{"ReduceLeft", "[", "r0", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"r0", ",", "dr"}], "}"}], "=", 
         RowBox[{"ReduceRight", "[", "r0", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"dr", "\[GreaterEqual]", 
           RowBox[{"m", "^", "2"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"r0", ",", "dr"}], "}"}], "=", 
           RowBox[{"ReduceRight", "[", "r0", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dl", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"BasisUL", "[", "r0", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"r0", ",", "dl", ",", "dr"}], "}"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.6363349459246454`*^9, 3.636388681250182*^9, {3.636395377205995*^9, 
   3.6363956494260993`*^9}, {3.636395697617279*^9, 3.6363957114552774`*^9}, {
   3.636395742438665*^9, 3.6363957464168944`*^9}, {3.636395785918373*^9, 
   3.636395805637911*^9}, {3.63639592418915*^9, 3.636395944766737*^9}, {
   3.6363959760465417`*^9, 3.6363959819280806`*^9}, {3.636396015580222*^9, 
   3.636396050292225*^9}, {3.636396102664446*^9, 3.63639612076149*^9}, {
   3.636396153538981*^9, 3.6363962186581373`*^9}, {3.636397128943053*^9, 
   3.636397264374466*^9}, {3.636397322020791*^9, 3.6363975061748147`*^9}, {
   3.6363975476732087`*^9, 3.636397665195789*^9}, {3.636397714323023*^9, 
   3.6363978278517723`*^9}, {3.63639800375292*^9, 3.6363980046109695`*^9}, {
   3.636398070727584*^9, 3.636398213024392*^9}, {3.6363982688600135`*^9, 
   3.636398315819723*^9}, {3.636398362091992*^9, 3.6363984988972845`*^9}, {
   3.6363985355125966`*^9, 3.636398646513*^9}, {3.636398694408763*^9, 
   3.6363988503553596`*^9}, {3.636398956224067*^9, 3.6363991176936007`*^9}, {
   3.636399160970497*^9, 3.6363992059946947`*^9}, {3.63641129818645*^9, 
   3.636411331869009*^9}, {3.636411439173687*^9, 3.636411445804112*^9}, {
   3.6364116469020023`*^9, 3.636411659585615*^9}, {3.6364117563908205`*^9, 
   3.636411794738078*^9}, {3.636412659506509*^9, 3.636412701458598*^9}, {
   3.636412840448907*^9, 3.6364128474849577`*^9}, {3.636413029955254*^9, 
   3.636413063060576*^9}, {3.63641311663441*^9, 3.636413196262914*^9}, {
   3.636413265219334*^9, 3.6364132984026613`*^9}, {3.636490913070015*^9, 
   3.636490925942817*^9}, {3.6364910198259587`*^9, 3.6364910254967527`*^9}, {
   3.636491161417779*^9, 3.6364911709391117`*^9}, {3.636492274480841*^9, 
   3.636492319952388*^9}, {3.636492711599532*^9, 3.636492734617035*^9}, {
   3.6364988181089053`*^9, 3.6364988235302057`*^9}, {3.6364988696444902`*^9, 
   3.6364988723392982`*^9}, {3.6364989312924757`*^9, 
   3.6364989450557785`*^9}, {3.636504241615554*^9, 3.6365044249863596`*^9}, {
   3.6365044622540665`*^9, 3.6365045116129494`*^9}, {3.6365045796962023`*^9, 
   3.636504803205491*^9}, {3.6388189915927134`*^9, 3.6388190266430635`*^9}, {
   3.6388192155259523`*^9, 3.6388192461562586`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simultaneous minimization", "Subsection",
 CellChangeTimes->{{3.6363348818612394`*^9, 3.6363348935194054`*^9}, {
  3.698308755828785*^9, 3.698308761062893*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "rPlus2", ",", " ", "rTimes2", ",", " ", "rInverse2", ",", "rBuild2"}], 
    "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rPlus2", "[", 
    RowBox[{"r1_", ",", "r2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"ReduceRepresentation1", "[", 
     RowBox[{"rPlus1", "[", 
      RowBox[{"r1", ",", "r2"}], "]"}], "]"}], "//", "First"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rTimes2", "[", 
    RowBox[{"r1_", ",", "r2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"ReduceRepresentation1", "[", 
     RowBox[{"rTimes1", "[", 
      RowBox[{"r1", ",", "r2"}], "]"}], "]"}], "//", "First"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rInverse2", "[", "r_", "]"}], ":=", 
    RowBox[{
     RowBox[{"ReduceRepresentation1", "[", 
      RowBox[{"rInverse1", "[", "r", "]"}], "]"}], "//", "First"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rBuild2", "[", 
    RowBox[{"rf_", ",", " ", "point_"}], "]"}], ":=", 
   RowBox[{"Which", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FreeQ", "[", 
      RowBox[{"rf", ",", "z"}], "]"}], ",", " ", 
     RowBox[{"rConst1", "[", 
      RowBox[{
       RowBox[{"Length", "[", "point", "]"}], ",", 
       RowBox[{"rf", "*", 
        RowBox[{"id", "[", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"point", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "1"}], "]"}], 
         "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Head", "[", "rf", "]"}], "===", "z"}], ",", " ", 
     RowBox[{"rX1", "[", 
      RowBox[{
       RowBox[{"Length", "[", "point", "]"}], ",", 
       RowBox[{"Last", "[", "rf", "]"}], ",", 
       RowBox[{"point", "[", 
        RowBox[{"[", 
         RowBox[{"Last", "[", "rf", "]"}], "]"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Head", "[", "rf", "]"}], "===", "inv"}], ",", " ", 
     RowBox[{"rInverse2", "[", 
      RowBox[{"rBuild2", "[", 
       RowBox[{
        RowBox[{"First", "[", "rf", "]"}], ",", "point"}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Head", "[", "rf", "]"}], "===", "Plus"}], ",", " ", 
     RowBox[{"rPlus2", "[", 
      RowBox[{
       RowBox[{"rBuild2", "[", 
        RowBox[{
         RowBox[{"First", "[", "rf", "]"}], ",", "point"}], "]"}], ",", " ", 
       RowBox[{"rBuild2", "[", 
        RowBox[{
         RowBox[{"Rest", "[", "rf", "]"}], ",", "point"}], "]"}]}], "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Head", "[", "rf", "]"}], "===", "Times"}], ",", " ", 
     RowBox[{"rL1", "[", 
      RowBox[{
       RowBox[{"rBuild2", "[", 
        RowBox[{
         RowBox[{"Rest", "[", "rf", "]"}], ",", "point"}], "]"}], ",", " ", 
       RowBox[{"First", "[", "rf", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Head", "[", "rf", "]"}], "===", "NonCommutativeMultiply"}], 
     ",", " ", 
     RowBox[{"rTimes2", "[", 
      RowBox[{
       RowBox[{"rBuild2", "[", 
        RowBox[{
         RowBox[{"First", "[", "rf", "]"}], ",", "point"}], "]"}], ",", " ", 
       RowBox[{"rBuild2", "[", 
        RowBox[{
         RowBox[{"Rest", "[", "rf", "]"}], ",", "point"}], "]"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.6363349459246454`*^9, 3.636388681250182*^9, {3.636395377205995*^9, 
   3.6363956494260993`*^9}, {3.636395697617279*^9, 3.6363957114552774`*^9}, {
   3.636395742438665*^9, 3.6363957464168944`*^9}, {3.636395785918373*^9, 
   3.636395805637911*^9}, {3.63639592418915*^9, 3.636395944766737*^9}, {
   3.6363959760465417`*^9, 3.6363959819280806`*^9}, {3.636396015580222*^9, 
   3.636396050292225*^9}, {3.636396102664446*^9, 3.63639612076149*^9}, {
   3.636396153538981*^9, 3.6363962186581373`*^9}, {3.636397128943053*^9, 
   3.636397264374466*^9}, {3.636397322020791*^9, 3.6363975061748147`*^9}, {
   3.6363975476732087`*^9, 3.636397665195789*^9}, {3.636397714323023*^9, 
   3.6363978278517723`*^9}, {3.63639800375292*^9, 3.6363980046109695`*^9}, {
   3.636398070727584*^9, 3.636398213024392*^9}, {3.6363982688600135`*^9, 
   3.636398315819723*^9}, {3.636398362091992*^9, 3.6363984988972845`*^9}, {
   3.6363985355125966`*^9, 3.636398646513*^9}, {3.636398694408763*^9, 
   3.6363988503553596`*^9}, {3.636398956224067*^9, 3.6363991176936007`*^9}, {
   3.636399160970497*^9, 3.6363992059946947`*^9}, {3.63641129818645*^9, 
   3.636411331869009*^9}, {3.636411439173687*^9, 3.636411445804112*^9}, {
   3.6364116469020023`*^9, 3.636411659585615*^9}, {3.6364117563908205`*^9, 
   3.636411794738078*^9}, {3.636412659506509*^9, 3.636412701458598*^9}, {
   3.636412840448907*^9, 3.6364128474849577`*^9}, {3.636413029955254*^9, 
   3.636413063060576*^9}, {3.63641311663441*^9, 3.636413196262914*^9}, {
   3.636413265219334*^9, 3.6364132984026613`*^9}, {3.636490913070015*^9, 
   3.636490925942817*^9}, {3.6364910198259587`*^9, 3.6364910254967527`*^9}, {
   3.636491161417779*^9, 3.6364911709391117`*^9}, {3.636492274480841*^9, 
   3.636492319952388*^9}, {3.636492711599532*^9, 3.636492734617035*^9}, {
   3.6364988181089053`*^9, 3.6364988235302057`*^9}, {3.6364988696444902`*^9, 
   3.6364988723392982`*^9}, {3.6364989312924757`*^9, 
   3.6364989450557785`*^9}, {3.636504241615554*^9, 3.6365044249863596`*^9}, {
   3.6365044622540665`*^9, 3.6365045116129494`*^9}, {3.6365045796962023`*^9, 
   3.636504803205491*^9}, {3.6388189915927134`*^9, 3.6388190266430635`*^9}, {
   3.6388192155259523`*^9, 3.6388192461562586`*^9}, 3.6983087995661983`*^9, {
   3.698308832869011*^9, 3.698309104713619*^9}, {3.698309231563389*^9, 
   3.6983092375067997`*^9}, 3.699205432317388*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Zero series test", "Section",
 CellChangeTimes->{{3.636498410987006*^9, 3.6364984175485153`*^9}, {
  3.6364999154639316`*^9, 3.6364999183246183`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "ZeroSeriesQ", "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "checks", " ", "whether", " ", "a", " ", "representation", " ", "yields", 
    " ", "the", " ", "zero", " ", "series"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ZeroSeriesQ", "[", "r_", "]"}], ":=", 
   RowBox[{"Which", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"r", "===", "\"\<Undefined\>\""}], ",", "False", ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rDim", "[", "r", "]"}], "\[Equal]", "0"}], ",", "True", ",", 
     "\[IndentingNewLine]", "True", ",", " ", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"S", "=", 
          RowBox[{"BasisUL", "[", "r", "]"}]}], ",", " ", "mat"}], "}"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mat", "=", 
         RowBox[{"Flatten", "/@", 
          RowBox[{"Append", "[", 
           RowBox[{"S", ",", 
            RowBox[{"r", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{
          RowBox[{"MatrixRank", "[", "mat", "]"}], "\[Equal]", 
          RowBox[{"Length", "[", "S", "]"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6364984318418016`*^9, 3.636498496577756*^9}, {
   3.636498549321411*^9, 3.6364985944922495`*^9}, 3.6364989718432055`*^9, {
   3.636499017686553*^9, 3.6364990678455963`*^9}, {3.6364992045180626`*^9, 
   3.6364992415879574`*^9}, {3.636499922805693*^9, 3.6365000022257495`*^9}, {
   3.6365000466574106`*^9, 3.6365000834862475`*^9}, {3.636500164066582*^9, 
   3.636500164486683*^9}, {3.6365002014765587`*^9, 3.6365002409770365`*^9}, {
   3.6365002947899485`*^9, 3.6365003152248516`*^9}, {3.636500351924658*^9, 
   3.6365005416998405`*^9}, {3.6365006099897795`*^9, 3.636500646363768*^9}, {
   3.6365008465211096`*^9, 3.6365009328185205`*^9}, {3.636500975487241*^9, 
   3.636501030915578*^9}, {3.636505724466099*^9, 3.6365057258563213`*^9}, {
   3.6365061274881682`*^9, 3.636506128143473*^9}, {3.6365061791014214`*^9, 
   3.636506181909889*^9}, {3.63650626040757*^9, 3.636506261686983*^9}, {
   3.636506303626772*^9, 3.6365063764295034`*^9}, {3.636565152501462*^9, 
   3.6365652930395365`*^9}, 3.636570619254884*^9, {3.636579765537588*^9, 
   3.6365797868405695`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Symmetric representations", "Section",
 CellChangeTimes->{{3.6363997807504516`*^9, 3.636399789720969*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "ReprH", ",", " ", "matS", ",", " ", "SymRepr", ",", " ", "EvaluationS", 
     ",", " ", "Sym2Normal"}], "]"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"returns", " ", "the", " ", "adjoint", " ", "representation"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ReprH", "[", "r_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"r", "===", "\"\<Undefined\>\""}], "||", 
       RowBox[{
        RowBox[{"rDim", "[", "r", "]"}], "\[Equal]", "0"}]}], ",", "r", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"b", "=", 
           RowBox[{"First", "[", "r", "]"}]}], ",", " ", 
          RowBox[{"A", "=", 
           RowBox[{"Most", "[", 
            RowBox[{"Rest", "[", "r", "]"}], "]"}]}], ",", " ", 
          RowBox[{"c", "=", 
           RowBox[{"Last", "[", "r", "]"}]}], ",", " ", "\[IndentingNewLine]",
           "m", ",", " ", "e", ",", " ", "com", ",", " ", "aux", ",", " ", 
          "bH", ",", " ", "AH", ",", " ", "cH"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"b", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"e", "[", "j_", "]"}], ":=", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{"UnitVector", "[", 
             RowBox[{"m", ",", "j"}], "]"}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"com", "=", 
          RowBox[{"Sum", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"KroneckerProduct", "[", 
             RowBox[{
              RowBox[{"KroneckerProduct", "[", 
               RowBox[{
                RowBox[{"Transpose", "[", 
                 RowBox[{"e", "[", "j", "]"}], "]"}], ",", 
                RowBox[{"id", "[", "m", "]"}]}], "]"}], ",", 
              RowBox[{"e", "[", "j", "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"j", ",", "m"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"bH", "=", 
          RowBox[{"Map", "[", 
           RowBox[{"ConjugateTranspose", ",", 
            RowBox[{"Transpose", "[", "c", "]"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"cH", "=", 
          RowBox[{"Map", "[", 
           RowBox[{"ConjugateTranspose", ",", 
            RowBox[{"Transpose", "[", "b", "]"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"aux", "[", "mat_", "]"}], ":=", 
          RowBox[{"com", ".", 
           RowBox[{"ConjugateTranspose", "[", "mat", "]"}], ".", "com"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"AH", "=", 
          RowBox[{"Map", "[", 
           RowBox[{"aux", ",", 
            RowBox[{"Transpose", "/@", "A"}], ",", 
            RowBox[{"{", "3", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Prepend", "[", 
             RowBox[{"AH", ",", "bH"}], "]"}], ",", "cH"}], "]"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "if", " ", "r", " ", "totally", " ", "reduced", " ", "and", " ", 
     "represents", " ", "Hermitian", " ", "series"}], ",", " ", 
    RowBox[{
    "then", " ", "matS", " ", "returns", " ", "the", " ", "unique", " ", 
     "matrix", " ", "S", " ", "that", " ", "yields", " ", "the", " ", 
     "equivalence", " ", "between", " ", "r", " ", "and", " ", "its", " ", 
     "adjoint"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"matS", "[", "r_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"r", "===", "\"\<Undefined\>\""}], "||", 
       RowBox[{
        RowBox[{"rDim", "[", "r", "]"}], "\[Equal]", "0"}]}], ",", 
      "\"\<Undefined\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"rH", "=", 
           RowBox[{"ReprH", "[", "r", "]"}]}], ",", 
          RowBox[{"A", "=", 
           RowBox[{"Most", "[", 
            RowBox[{"Rest", "[", "r", "]"}], "]"}]}], ",", " ", 
          RowBox[{"c", "=", 
           RowBox[{"Last", "[", "r", "]"}]}], ",", " ", "\[IndentingNewLine]",
           "m", ",", " ", "n", ",", " ", "cH", ",", " ", "AH", ",", " ", "s", 
          ",", " ", "S0", ",", " ", "S", ",", " ", "eqs", ",", " ", "i", ",", 
          " ", "sol"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"c", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"n", "=", 
          RowBox[{"Length", "[", "c", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"cH", "=", 
          RowBox[{"Last", "[", "rH", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AH", "=", 
          RowBox[{"Most", "[", 
           RowBox[{"Rest", "[", "rH", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"S0", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            SubscriptBox["s", 
             RowBox[{"i", ",", "j"}]], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"m", " ", "n"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"m", " ", "n"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"S", "=", 
          RowBox[{"Partition", "[", 
           RowBox[{"S0", ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"eqs", "=", 
          RowBox[{"{", 
           RowBox[{"cH", "+", 
            RowBox[{"BlockMult", "[", 
             RowBox[{"S", ",", "c", ",", "\"\<\>\""}], "]"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "\[LessEqual]", 
            RowBox[{"Length", "[", "A", "]"}]}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"eqs", ",", 
             RowBox[{
              RowBox[{"BlockMult", "[", 
               RowBox[{"S", ",", 
                RowBox[{"A", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "\"\<L\>\""}], "]"}], 
              "-", 
              RowBox[{"BlockMult", "[", 
               RowBox[{
                RowBox[{"AH", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "S", ",", "\"\<R\>\""}],
                "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"sol", "=", 
          RowBox[{"LinearSolve", "@@", 
           RowBox[{"(", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"CoefficientArrays", "[", 
               RowBox[{
                RowBox[{"Flatten", "[", "eqs", "]"}], ",", 
                RowBox[{"Flatten", "[", "S0", "]"}]}], "]"}], "//", 
              "Normal"}], "//", "Reverse"}], "\[IndentingNewLine]", ")"}]}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"Partition", "[", 
           RowBox[{"sol", ",", 
            RowBox[{"m", " ", "n"}]}], "]"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "assumming", " ", "that", " ", "r", " ", "is", " ", "totally", " ", 
     "reduced", " ", "and", " ", "represents", " ", "Hermitian", " ", 
     "series"}], ",", 
    RowBox[{"it", " ", "returns", " ", "symmetric", " ", "representation"}]}],
    " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SymRepr", "[", "r_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"r", "===", "\"\<Undefined\>\""}], "||", 
       RowBox[{
        RowBox[{"rDim", "[", "r", "]"}], "\[Equal]", "0"}]}], ",", " ", "r", 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"S", "=", 
           RowBox[{"N", "[", 
            RowBox[{"matS", "[", "r", "]"}], "]"}]}], ",", " ", 
          RowBox[{"A", "=", 
           RowBox[{"Most", "[", 
            RowBox[{"Rest", "[", "r", "]"}], "]"}]}], ",", " ", 
          RowBox[{"c", "=", 
           RowBox[{"Last", "[", "r", "]"}]}], ",", " ", "\[IndentingNewLine]",
           "m", ",", " ", "u", ",", " ", "d", ",", " ", "aux", ",", " ", "rh",
           ",", " ", "rhinv", ",", " ", "signJ", ",", " ", "sc", ",", " ", 
          "sA"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"m", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"c", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"u", "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{"Orthogonalize", "[", 
            RowBox[{"Eigenvectors", "[", "S", "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"d", "=", 
          RowBox[{"Chop", "[", 
           RowBox[{
            RowBox[{"ConjugateTranspose", "[", "u", "]"}], ".", "S", ".", 
            "u"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"rh", "=", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sqrt", "[", 
              RowBox[{"Abs", "[", "d", "]"}], "]"}], ".", 
             RowBox[{"ConjugateTranspose", "[", "u", "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"rhinv", "=", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"u", ".", 
             RowBox[{"Inverse", "[", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"Abs", "[", "d", "]"}], "]"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"signJ", "=", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"Sign", "[", "d", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"sc", "=", 
          RowBox[{"BlockMult", "[", 
           RowBox[{"signJ", ",", 
            RowBox[{"BlockMult", "[", 
             RowBox[{"rh", ",", "c", ",", "\"\<\>\""}], "]"}], ",", 
            "\"\<\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"aux", "[", "mat_", "]"}], ":=", 
          RowBox[{"BlockMult", "[", 
           RowBox[{
            RowBox[{"BlockMult", "[", 
             RowBox[{"signJ", ",", "rh", ",", "\"\<\>\""}], "]"}], ",", 
            RowBox[{"BlockMult", "[", 
             RowBox[{"mat", ",", "rhinv", ",", "\"\<R\>\""}], "]"}], ",", 
            "\"\<L\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"sA", "=", 
          RowBox[{"aux", "/@", "A"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Prepend", "[", 
             RowBox[{"sA", ",", "signJ"}], "]"}], ",", "sc"}], "]"}], 
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"converts", " ", 
    RowBox[{"(", 
     RowBox[{"J", ",", "A", ",", "c"}], ")"}], " ", "to", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["c", "*"], ",", "JA", ",", "Jc"}], ")"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Sym2Normal", "[", "r_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"r", "===", "\"\<Undefined\>\""}], "||", 
       RowBox[{
        RowBox[{"rDim", "[", "r", "]"}], "\[Equal]", "0"}]}], ",", " ", "r", 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"signJ", "=", 
           RowBox[{"First", "[", "r", "]"}]}], ",", " ", 
          RowBox[{"A", "=", 
           RowBox[{"Most", "[", 
            RowBox[{"Rest", "[", "r", "]"}], "]"}]}], ",", " ", 
          RowBox[{"c", "=", 
           RowBox[{"Last", "[", "r", "]"}]}], ",", " ", "\[IndentingNewLine]",
           "bb", ",", " ", "AA", ",", " ", "cc"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"bb", "=", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"ConjugateTranspose", ",", "c", ",", 
             RowBox[{"{", "2", "}"}]}], "]"}], "//", "Transpose"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AA", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"BlockMult", "[", 
             RowBox[{"signJ", ",", "#", ",", "\"\<L\>\""}], "]"}], "&"}], "/@",
            "A"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"cc", "=", 
          RowBox[{"BlockMult", "[", 
           RowBox[{"signJ", ",", "c", ",", "\"\<\>\""}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Prepend", "[", 
             RowBox[{"AA", ",", "bb"}], "]"}], ",", "cc"}], "]"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "evaluation", " ", "of", " ", "a", " ", "symmetric", " ", 
    "representation"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EvaluationS", "[", 
    RowBox[{"r_", ",", "t_"}], "]"}], ":=", 
   RowBox[{"Evaluation", "[", 
    RowBox[{
     RowBox[{"Sym2Normal", "[", "r", "]"}], ",", "t"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.636399791733485*^9, 3.636399792544732*^9}, {
   3.6365012342760005`*^9, 3.636501355821416*^9}, {3.6365013872551875`*^9, 
   3.636501407477614*^9}, {3.636501440401677*^9, 3.6365014728893986`*^9}, {
   3.6365015118460197`*^9, 3.6365015384315386`*^9}, {3.636501637169321*^9, 
   3.636501738167488*^9}, {3.6365017738613214`*^9, 3.636501798814074*^9}, {
   3.636502160985443*^9, 3.636502180788403*^9}, {3.636502299309102*^9, 
   3.6365023007733955`*^9}, {3.63650254419707*^9, 3.636502554059042*^9}, {
   3.6365025972135415`*^9, 3.63650273959843*^9}, {3.636502778121495*^9, 
   3.636502807606187*^9}, {3.6365028415900683`*^9, 3.636502859116913*^9}, {
   3.636502942714842*^9, 3.636503001849126*^9}, {3.6365031531166887`*^9, 
   3.6365032071741076`*^9}, {3.636503663044858*^9, 3.6365036872189665`*^9}, {
   3.6365037360382643`*^9, 3.63650379609857*^9}, {3.6365038406775928`*^9, 
   3.6365038437581472`*^9}, {3.636503888386179*^9, 3.6365040107401986`*^9}, {
   3.636504847548395*^9, 3.6365048523876204`*^9}, {3.6365686677861547`*^9, 
   3.6365686708130393`*^9}, {3.6365695307101116`*^9, 
   3.6365695398212957`*^9}, {3.6365699024945135`*^9, 
   3.6365699632174287`*^9}, {3.6365700140896025`*^9, 3.636570123405793*^9}, {
   3.636570191836093*^9, 3.636570436826365*^9}, {3.6365704761477647`*^9, 
   3.6365706008912115`*^9}, {3.6365706633837075`*^9, 3.636570677417514*^9}, {
   3.636570709813992*^9, 3.636570799802986*^9}, {3.636571022252779*^9, 
   3.636571028343997*^9}, {3.6365710603063884`*^9, 3.6365711213508005`*^9}, {
   3.636571212706687*^9, 3.63657123748065*^9}, 3.6365718270878353`*^9, {
   3.636571924412432*^9, 3.63657203410614*^9}, {3.636572075318201*^9, 
   3.63657208309859*^9}, {3.6365726169169717`*^9, 3.636572621994987*^9}, {
   3.6365728050298576`*^9, 3.6365728178916583`*^9}, {3.6365728651492734`*^9, 
   3.6365728849520454`*^9}, {3.636572948811505*^9, 3.636572953082145*^9}, {
   3.6365731294806013`*^9, 3.636573151953972*^9}, {3.63657319495042*^9, 
   3.636573199111044*^9}, {3.63657331009869*^9, 3.6365733212403607`*^9}, {
   3.6365733541753006`*^9, 3.636573382390532*^9}, {3.6365734357085285`*^9, 
   3.636573440179199*^9}, {3.6365734751944504`*^9, 3.6365735497366304`*^9}, {
   3.6365736053249674`*^9, 3.6365738822640147`*^9}, {3.636573965366479*^9, 
   3.6365739787584877`*^9}, {3.6365765100264*^9, 3.6365765156949673`*^9}, {
   3.6365776228336506`*^9, 3.636577647297075*^9}, {3.6365776798416305`*^9, 
   3.636577706385346*^9}, {3.6365781432595*^9, 3.636578261597065*^9}, {
   3.636578329227532*^9, 3.6365784752889776`*^9}, {3.63657850602328*^9, 
   3.636578645663827*^9}, {3.6365787155236063`*^9, 3.6365789058412466`*^9}, {
   3.6365789362765074`*^9, 3.6365789539089756`*^9}, 3.6365789941446075`*^9, {
   3.636579294598665*^9, 3.636579340525094*^9}, {3.636579418276978*^9, 
   3.6365794372396326`*^9}, {3.636579572449559*^9, 3.6365796661136703`*^9}, {
   3.6365797429344234`*^9, 3.636579747275031*^9}, {3.63657996250616*^9, 
   3.6365800200052085`*^9}, {3.636580133782135*^9, 3.636580238011882*^9}, {
   3.6365802865147343`*^9, 3.6365802893330984`*^9}, {3.636580560441015*^9, 
   3.636580650448412*^9}, {3.636580929563156*^9, 3.6365809622241354`*^9}, {
   3.6365810065854664`*^9, 3.6365810899880013`*^9}, {3.6365811244611034`*^9, 
   3.6365811351120625`*^9}, {3.6365814398404922`*^9, 3.63658179874306*^9}, {
   3.6365826436520033`*^9, 3.6365826467386203`*^9}, {3.636582682090604*^9, 
   3.636582688501373*^9}, {3.6365830635466285`*^9, 3.6365830821253433`*^9}, {
   3.6365831237515173`*^9, 3.63658316419637*^9}, {3.6365832177127914`*^9, 
   3.63658322353349*^9}, {3.6365832737595167`*^9, 3.636583282310542*^9}, {
   3.6365833280160265`*^9, 3.6365833376871867`*^9}, {3.6365833693209825`*^9, 
   3.636583404005144*^9}, {3.6365836073115377`*^9, 3.636583620023063*^9}, {
   3.636583796365222*^9, 3.636583796665258*^9}, {3.6365844382793713`*^9, 
   3.6365844416571074`*^9}, {3.63658456685563*^9, 3.6365846550668607`*^9}, {
   3.636584704697469*^9, 3.6365847268456354`*^9}, {3.6365854238084307`*^9, 
   3.636585432607395*^9}, {3.63658547917638*^9, 3.6365854795976067`*^9}, {
   3.636585655439436*^9, 3.63658572425677*^9}, {3.636585932623731*^9, 
   3.6365859439191446`*^9}, {3.636586493063692*^9, 3.636586567529651*^9}, {
   3.6365866319960494`*^9, 3.636586675102994*^9}, {3.6365867535629377`*^9, 
   3.6365867769807887`*^9}, {3.6365868290439944`*^9, 3.636586962015579*^9}, {
   3.636587073692116*^9, 3.6365870921642923`*^9}, {3.6365871304669747`*^9, 
   3.6365871327135906`*^9}, {3.6365871660851994`*^9, 3.636587222000975*^9}, {
   3.636587259319763*^9, 3.636587261067131*^9}, {3.6365872955982513`*^9, 
   3.636587296674755*^9}, {3.6365874036542406`*^9, 3.6365874575740247`*^9}, {
   3.636588250376207*^9, 3.6365882561487617`*^9}, {3.6365883067288246`*^9, 
   3.636588307134464*^9}, {3.6365883985599804`*^9, 3.636588433915659*^9}, 
   3.636588469692424*^9, {3.636588524199745*^9, 3.6365885703165255`*^9}, {
   3.6365886552522526`*^9, 3.6365886555641685`*^9}, {3.636589128249685*^9, 
   3.6365891884839873`*^9}, {3.636589235988119*^9, 3.6365892842098827`*^9}, {
   3.6365896807905617`*^9, 3.6365897238501496`*^9}, {3.636589781060117*^9, 
   3.6365898709080033`*^9}, 3.636590270522091*^9, {3.636590484323676*^9, 
   3.63659049550988*^9}, {3.636590836088442*^9, 3.636590846198149*^9}, {
   3.6365909016143217`*^9, 3.636590942443186*^9}, {3.6365922761816697`*^9, 
   3.6365923031408887`*^9}, {3.636592510336063*^9, 3.6365925712617826`*^9}, {
   3.6365926780854626`*^9, 3.6365926857869225`*^9}, 3.636592727849742*^9, {
   3.6365927614773717`*^9, 3.6365927618203516`*^9}, 3.6366445824556694`*^9, {
   3.636647088953388*^9, 3.6366471339773273`*^9}, {3.636674512222974*^9, 
   3.636674564518203*^9}, {3.638818068791485*^9, 3.6388180747715445`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Examples", "Section",
 CellChangeTimes->{{3.636399803683775*^9, 3.636399806148717*^9}, {
  3.699247753486964*^9, 3.6992477545179234`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SNC", "[", 
   RowBox[{"z", ",", "p"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.699247806037361*^9, 3.699247807778014*^9}, {
  3.699247893443323*^9, 3.6992479173907633`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rf", "=", 
     RowBox[{
      RowBox[{"inv", "[", 
       RowBox[{"z", "[", "1", "]"}], "]"}], "**", 
      RowBox[{"z", "[", "2", "]"}], "**", 
      RowBox[{"inv", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"z", "[", "1", "]"}], " ", "**", " ", 
         RowBox[{"z", "[", "2", "]"}]}], " ", "-", " ", 
        RowBox[{
         RowBox[{"z", "[", "2", "]"}], " ", "**", " ", 
         RowBox[{"z", "[", "1", "]"}]}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"point", " ", "=", " ", 
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", " ", "1"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"1", ",", " ", "0"}], "}"}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"1", ",", " ", "0"}], "}"}]}], "}"}]}], "}"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"r", "=", " ", 
     RowBox[{"rBuild1", "[", 
      RowBox[{"rf", ",", " ", "point"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rr", "=", 
     RowBox[{
      RowBox[{"ReduceRepresentation1", "[", "r", "]"}], "//", "First"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"rr", "//", "RepresentationForm1"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6983080834341583`*^9, 3.698308216586812*^9}, {
   3.6983082784365573`*^9, 3.6983083319897966`*^9}, {3.6983083927115803`*^9, 
   3.698308463053746*^9}, 3.698308495454376*^9, {3.6983085268695865`*^9, 
   3.6983085280520415`*^9}, {3.6983086673872643`*^9, 
   3.6983086717440977`*^9}, {3.6992055065602336`*^9, 
   3.6992055236436496`*^9}, {3.6992055726634517`*^9, 3.699205593125543*^9}, {
   3.6992056290687304`*^9, 3.699205631873291*^9}, {3.699206655706276*^9, 
   3.699206670368464*^9}, {3.6992477574233932`*^9, 3.699247757728447*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rf", "=", 
     RowBox[{"inv", "[", 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"inv", "[", 
         RowBox[{"z", "[", "1", "]"}], "]"}], "**", 
        RowBox[{"z", "[", "2", "]"}], "**", 
        RowBox[{"inv", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"z", "[", "1", "]"}], " ", "**", " ", 
           RowBox[{"z", "[", "2", "]"}]}], " ", "-", " ", 
          RowBox[{
           RowBox[{"z", "[", "2", "]"}], " ", "**", " ", 
           RowBox[{"z", "[", "1", "]"}]}]}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"inv", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"z", "[", "1", "]"}], " ", "**", " ", 
           RowBox[{"z", "[", "2", "]"}]}], " ", "-", " ", 
          RowBox[{
           RowBox[{"z", "[", "2", "]"}], " ", "**", " ", 
           RowBox[{"z", "[", "1", "]"}]}]}], "]"}], "**", 
        RowBox[{"z", "[", "1", "]"}], "**", 
        RowBox[{"inv", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"z", "[", "1", "]"}], " ", "**", " ", 
           RowBox[{"z", "[", "2", "]"}]}], " ", "-", " ", 
          RowBox[{
           RowBox[{"z", "[", "2", "]"}], " ", "**", " ", 
           RowBox[{"z", "[", "1", "]"}]}]}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"point", " ", "=", " ", 
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", " ", "1"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"1", ",", " ", "0"}], "}"}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"1", ",", " ", "0"}], "}"}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"r", "=", " ", 
     RowBox[{"rBuild2", "[", 
      RowBox[{"rf", ",", " ", "point"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"r", "//", "RepresentationForm1"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "//", "MatrixForm"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6983091316007423`*^9, 3.6983091995257607`*^9}, {
  3.6983092561852436`*^9, 3.698309306020378*^9}, {3.6983093375858064`*^9, 
  3.698309341418643*^9}, {3.698309619670846*^9, 3.6983096199254484`*^9}, {
  3.6983097908268576`*^9, 3.698309797462676*^9}, {3.6983098881048794`*^9, 
  3.6983099204524317`*^9}, {3.6992055065702353`*^9, 3.6992055236496506`*^9}, {
  3.699206678969223*^9, 3.699206685566621*^9}, {3.6992477619897537`*^9, 
  3.699247762239706*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rf", " ", "=", " ", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"z", "[", "1", "]"}], " ", "**", " ", 
        RowBox[{"z", "[", "2", "]"}]}], " ", "-", " ", 
       RowBox[{
        RowBox[{"z", "[", "2", "]"}], " ", "**", " ", 
        RowBox[{"z", "[", "1", "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"point", " ", "=", " ", 
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "1"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0"}], "}"}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"1", ",", " ", "0"}], "}"}]}], "}"}]}], "}"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"r", " ", "=", " ", 
     RowBox[{"rBuild1", "[", 
      RowBox[{"rf", ",", " ", "point"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rr", "=", 
     RowBox[{
      RowBox[{"ReduceRepresentation1", "[", "r", "]"}], "//", "First"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"testfun2", "[", "tuple_", "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Evaluation", "[", 
         RowBox[{"r", ",", 
          RowBox[{"tuple", "-", "point"}]}], "]"}], "-", 
        RowBox[{"Inverse", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"tuple", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ".", 
           RowBox[{"tuple", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"tuple", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ".", 
           RowBox[{"tuple", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Evaluation", "[", 
         RowBox[{"rr", ",", 
          RowBox[{"tuple", "-", "point"}]}], "]"}], "-", 
        RowBox[{"Inverse", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"tuple", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ".", 
           RowBox[{"tuple", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "-", 
          RowBox[{
           RowBox[{"tuple", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ".", 
           RowBox[{"tuple", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"first", "=", 
        RowBox[{
         RowBox[{"RandomInteger", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "2"}], "}"}]}], "]"}], "/", 
         RowBox[{"RandomChoice", "[", 
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"-", "11"}], ",", "11", ",", "2"}], "]"}], "]"}]}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"second", "=", 
        RowBox[{
         RowBox[{"RandomInteger", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "10"}], ",", "10"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "2"}], "}"}]}], "]"}], "/", 
         RowBox[{"RandomChoice", "[", 
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"-", "11"}], ",", "11", ",", "2"}], "]"}], "]"}]}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"Norm", "/@", 
         RowBox[{"testfun2", "[", 
          RowBox[{"{", 
           RowBox[{"first", ",", "second"}], "}"}], "]"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "10", "}"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6364151191127663`*^9, 3.6364151731546307`*^9}, {
   3.6364156447300577`*^9, 3.6364156517193055`*^9}, {3.6364159860965385`*^9, 
   3.6364160745864105`*^9}, {3.6364179892363844`*^9, 
   3.6364180887033463`*^9}, {3.636418123722595*^9, 3.6364182922143955`*^9}, {
   3.6364183478021593`*^9, 3.6364183511251717`*^9}, {3.6364201744824524`*^9, 
   3.6364201947325506`*^9}, {3.636489902280718*^9, 3.636490007986515*^9}, {
   3.6364929840677185`*^9, 3.6364930640647106`*^9}, {3.636493217117613*^9, 
   3.636493226181331*^9}, {3.6364934296626005`*^9, 3.636493435832533*^9}, {
   3.636505341841487*^9, 3.6365053554762135`*^9}, {3.6365676556466293`*^9, 
   3.636567749164819*^9}, {3.6365677801967993`*^9, 3.636567785829049*^9}, 
   3.636568651902809*^9, {3.6365818599814076`*^9, 3.636581866132146*^9}, {
   3.6388196404107676`*^9, 3.638819642321875*^9}, {3.638819685738042*^9, 
   3.638819688819828*^9}, {3.698307555698229*^9, 3.6983075790473833`*^9}, 
   3.6983080817598248`*^9, {3.6992055065782375`*^9, 3.6992055238106833`*^9}, {
   3.699206726002634*^9, 3.699206736321742*^9}, 3.699247764796626*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"posdimzero", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "}"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"KroneckerProduct", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
           RowBox[{"id", "[", "2", "]"}]}], "]"}], "}"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "}"}], "}"}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ZeroSeriesQ", "[", "posdimzero", "]"}], "//", "Print"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ZeroSeriesQ", "[", 
      RowBox[{"rBuild1", "[", 
       RowBox[{
        RowBox[{"z", "[", "1", "]"}], ",", 
        RowBox[{"{", "0", "}"}]}], "]"}], "]"}], "//", "Print"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ZeroSeriesQ", "[", 
      RowBox[{"rPlus1", "[", 
       RowBox[{
        RowBox[{"rBuild1", "[", 
         RowBox[{
          RowBox[{"z", "[", "1", "]"}], ",", 
          RowBox[{"{", "0", "}"}]}], "]"}], ",", 
        RowBox[{"rBuild1", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"z", "[", "1", "]"}]}], ",", 
          RowBox[{"{", "0", "}"}]}], "]"}]}], "]"}], "]"}], "//", "Print"}], 
    ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6365049368341064`*^9, 3.6365049625526648`*^9}, {
  3.6365050041351595`*^9, 3.6365052317988186`*^9}, {3.6365053665713596`*^9, 
  3.636505368321587*^9}, {3.6365054249689503`*^9, 3.6365054304196587`*^9}, {
  3.6365063964476395`*^9, 3.6365063991000814`*^9}, {3.638819703769494*^9, 
  3.638819713224975*^9}, {3.699205506581238*^9, 3.699205506582238*^9}, {
  3.6992067424148397`*^9, 3.699206744529305*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rf", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"z", "[", "1", "]"}], "**", 
       RowBox[{"inv", "[", 
        RowBox[{
         RowBox[{"z", "[", "2", "]"}], "-", 
         RowBox[{"1", "/", "2"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"inv", "[", 
        RowBox[{
         RowBox[{"z", "[", "2", "]"}], "-", 
         RowBox[{"1", "/", "2"}]}], "]"}], "**", 
       RowBox[{"z", "[", "1", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"point", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"r", "=", 
     RowBox[{"rBuild1", "[", 
      RowBox[{"rf", ",", "point"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rr", "=", 
     RowBox[{
      RowBox[{"ReduceRepresentation1", "[", "r", "]"}], "//", "First"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rsym", "=", 
     RowBox[{"SymRepr", "[", "rr", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"rsym", "//", "RepresentationForm1"}], "//", "Print"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"symmat", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Norm", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"EvaluationS", "[", 
        RowBox[{"rsym", ",", 
         RowBox[{"{", 
          RowBox[{"symmat", ",", "symmat"}], "}"}]}], "]"}], "-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"symmat", ".", 
          RowBox[{"Inverse", "[", 
           RowBox[{"symmat", "-", 
            RowBox[{
             RowBox[{"1", "/", "2"}], "*", 
             RowBox[{"id", "[", "2", "]"}]}]}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"Inverse", "[", 
           RowBox[{"symmat", "-", 
            RowBox[{
             RowBox[{"1", "/", "2"}], "*", 
             RowBox[{"id", "[", "2", "]"}]}]}], "]"}], ".", "symmat"}]}], 
        ")"}]}], "\[IndentingNewLine]", "]"}], "//", "Print"}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.636581847689933*^9, 3.6365819541827106`*^9}, {
   3.6365820063799734`*^9, 3.636582325760295*^9}, {3.636582358234191*^9, 
   3.636582396708808*^9}, {3.636582942492848*^9, 3.636582945243178*^9}, {
   3.636583011208163*^9, 3.636583011374196*^9}, {3.636583412527167*^9, 
   3.6365834176977873`*^9}, {3.6365834673637466`*^9, 3.636583512059109*^9}, {
   3.636583542282736*^9, 3.6365835778270006`*^9}, {3.636583745488117*^9, 
   3.6365837465582457`*^9}, {3.6365837831736393`*^9, 3.636583785653937*^9}, {
   3.63658428223652*^9, 3.6365842939979305`*^9}, 3.6365846730037556`*^9, {
   3.636585204614381*^9, 3.636585218514872*^9}, {3.636589077422604*^9, 
   3.6365891037253847`*^9}, {3.63658920459951*^9, 3.6365892084372826`*^9}, {
   3.636589309530121*^9, 3.6365894212651987`*^9}, {3.636589455431608*^9, 
   3.6365894620620756`*^9}, {3.636590007919326*^9, 3.636590065379282*^9}, {
   3.636590107347048*^9, 3.636590155024926*^9}, {3.636591294114343*^9, 
   3.636591308530037*^9}, {3.6365914432335243`*^9, 3.636591462314037*^9}, {
   3.6365927734193115`*^9, 3.6365927821205044`*^9}, {3.6388197294043536`*^9, 
   3.63881973148556*^9}, {3.6388198444950676`*^9, 3.638819896996501*^9}, {
   3.698307877432789*^9, 3.698307883991993*^9}, {3.699205506584238*^9, 
   3.6992055238136835`*^9}, {3.699206749967765*^9, 3.6992067567539797`*^9}, 
   3.699247768458334*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rf", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"inv", "[", 
        RowBox[{
         RowBox[{"z", "[", "1", "]"}], "+", "1"}], "]"}], "**", 
       RowBox[{"z", "[", "2", "]"}], "**", 
       RowBox[{"inv", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"z", "[", "1", "]"}], " ", "**", " ", 
          RowBox[{"z", "[", "2", "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"z", "[", "2", "]"}], " ", "**", " ", 
          RowBox[{"z", "[", "1", "]"}]}]}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"inv", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"z", "[", "1", "]"}], " ", "**", " ", 
          RowBox[{"z", "[", "2", "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"z", "[", "2", "]"}], " ", "**", " ", 
          RowBox[{"z", "[", "1", "]"}]}]}], "]"}], "**", 
       RowBox[{"z", "[", "1", "]"}], "**", 
       RowBox[{"inv", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"inv", "[", 
           RowBox[{"z", "[", "1", "]"}], "]"}], " ", "**", " ", 
          RowBox[{"z", "[", "2", "]"}]}], " ", "-", " ", 
         RowBox[{
          RowBox[{"z", "[", "2", "]"}], " ", "**", " ", 
          RowBox[{"inv", "[", 
           RowBox[{"z", "[", "1", "]"}], "]"}]}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"point", " ", "=", " ", 
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", " ", "1"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", " ", "0"}], "}"}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"1", ",", " ", "0"}], "}"}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"r", "=", " ", 
     RowBox[{"rBuild2", "[", 
      RowBox[{"rf", ",", " ", "point"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"r", "//", "RepresentationForm1"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.698309934377315*^9, 3.6983099836977863`*^9}, {
   3.698310024734433*^9, 3.6983100456715083`*^9}, {3.6983101339624586`*^9, 
   3.6983101689262486`*^9}, {3.6992055065872393`*^9, 3.699205523980717*^9}, {
   3.69920676730649*^9, 3.699206772915538*^9}, 3.699247771296631*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rf", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"inv", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"z", "[", "2", "]"}], "**", 
          RowBox[{"inv", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"z", "[", "1", "]"}], " ", "**", " ", 
             RowBox[{"z", "[", "2", "]"}]}], " ", "-", " ", 
            RowBox[{
             RowBox[{"z", "[", "2", "]"}], " ", "**", " ", 
             RowBox[{"z", "[", "1", "]"}]}]}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"inv", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"z", "[", "1", "]"}], " ", "**", " ", 
             RowBox[{"z", "[", "2", "]"}]}], " ", "-", " ", 
            RowBox[{
             RowBox[{"z", "[", "2", "]"}], " ", "**", " ", 
             RowBox[{"z", "[", "1", "]"}]}]}], "]"}], "**", 
          RowBox[{"z", "[", "1", "]"}]}]}], "]"}], "**", 
       RowBox[{"inv", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"z", "[", "2", "]"}], "**", 
          RowBox[{"inv", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"z", "[", "1", "]"}], " ", "**", " ", 
             RowBox[{"z", "[", "2", "]"}]}], " ", "-", " ", 
            RowBox[{
             RowBox[{"z", "[", "2", "]"}], " ", "**", " ", 
             RowBox[{"z", "[", "1", "]"}]}]}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"inv", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"z", "[", "1", "]"}], " ", "**", " ", 
             RowBox[{"z", "[", "2", "]"}]}], " ", "+", " ", 
            RowBox[{
             RowBox[{"z", "[", "2", "]"}], " ", "**", " ", 
             RowBox[{"z", "[", "1", "]"}]}]}], "]"}], "**", 
          RowBox[{"z", "[", "1", "]"}]}]}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"inv", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"z", "[", "2", "]"}], "**", 
          RowBox[{"inv", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"z", "[", "1", "]"}], " ", "**", " ", 
             RowBox[{"z", "[", "2", "]"}]}], " ", "-", " ", 
            RowBox[{
             RowBox[{"z", "[", "2", "]"}], " ", "**", " ", 
             RowBox[{"z", "[", "1", "]"}]}]}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"inv", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"z", "[", "1", "]"}], " ", "**", " ", 
             RowBox[{"z", "[", "2", "]"}]}], " ", "+", " ", 
            RowBox[{
             RowBox[{"z", "[", "2", "]"}], " ", "**", " ", 
             RowBox[{"z", "[", "1", "]"}]}]}], "]"}], "**", 
          RowBox[{"z", "[", "1", "]"}]}]}], "]"}], "**", 
       RowBox[{"inv", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"z", "[", "2", "]"}], "**", 
          RowBox[{"inv", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"z", "[", "1", "]"}], " ", "**", " ", 
             RowBox[{"z", "[", "2", "]"}]}], " ", "-", " ", 
            RowBox[{
             RowBox[{"z", "[", "2", "]"}], " ", "**", " ", 
             RowBox[{"z", "[", "1", "]"}]}]}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"inv", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"z", "[", "1", "]"}], " ", "**", " ", 
             RowBox[{"z", "[", "2", "]"}]}], " ", "-", " ", 
            RowBox[{
             RowBox[{"z", "[", "2", "]"}], " ", "**", " ", 
             RowBox[{"z", "[", "1", "]"}]}]}], "]"}], "**", 
          RowBox[{"z", "[", "1", "]"}]}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"point", " ", "=", " ", 
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", " ", "1"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0"}], "}"}]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"1", ",", " ", "0"}], "}"}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"r", "=", " ", 
     RowBox[{"rBuild2", "[", 
      RowBox[{"rf", ",", " ", "point"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"r", "//", "RepresentationForm1"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6983101751253586`*^9, 3.698310340494054*^9}, {
   3.6983104139241123`*^9, 3.6983104168149395`*^9}, {3.6992055065932407`*^9, 
   3.6992055236116433`*^9}, {3.699206782501898*^9, 3.699206788179659*^9}, 
   3.699247774179242*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1047, 696},
WindowMargins->{{98, Automatic}, {Automatic, 0}},
ShowSelection->True,
Magnification->0.8999999761581421,
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 210, 4, 28, "Input"],
Cell[770, 26, 231, 5, 28, "Input"],
Cell[CellGroupData[{
Cell[1026, 35, 122, 1, 82, "Title"],
Cell[1151, 38, 271, 9, 8, "Text"],
Cell[CellGroupData[{
Cell[1447, 51, 199, 3, 57, "Section"],
Cell[CellGroupData[{
Cell[1671, 58, 111, 1, 35, "Subsection"],
Cell[1785, 61, 4274, 112, 286, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6096, 178, 157, 2, 35, "Subsection"],
Cell[6256, 182, 3011, 56, 301, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9304, 243, 130, 2, 35, "Subsection"],
Cell[9437, 247, 1197, 25, 94, "Input"],
Cell[10637, 274, 271, 9, 7, "Text"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[10957, 289, 164, 2, 45, "Section"],
Cell[CellGroupData[{
Cell[11146, 295, 111, 1, 35, "Subsection"],
Cell[11260, 298, 16970, 449, 1257, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28267, 752, 227, 3, 35, "Subsection"],
Cell[28497, 757, 5128, 124, 402, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[33674, 887, 136, 2, 45, "Section"],
Cell[CellGroupData[{
Cell[33835, 893, 168, 2, 35, "Subsection"],
Cell[34006, 897, 16695, 419, 1174, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50738, 1321, 164, 2, 35, "Subsection"],
Cell[50905, 1325, 23225, 559, 1907, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74167, 1889, 222, 3, 35, "Subsection"],
Cell[74392, 1894, 16091, 365, 1017, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90520, 2264, 121, 1, 35, "Subsection"],
Cell[90644, 2267, 3272, 80, 197, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[93965, 2353, 99, 1, 45, "Section"],
Cell[CellGroupData[{
Cell[94089, 2358, 381, 13, 35, "Subsection"],
Cell[94473, 2373, 11201, 278, 949, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[105711, 2656, 111, 1, 35, "Subsection"],
Cell[105825, 2659, 4055, 95, 351, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[109917, 2759, 111, 1, 35, "Subsection"],
Cell[110031, 2762, 9838, 224, 222, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[119906, 2991, 111, 1, 29, "Subsection"],
Cell[120020, 2994, 18674, 451, 1496, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[138731, 3450, 166, 2, 35, "Subsection"],
Cell[138900, 3454, 5911, 132, 248, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[144860, 3592, 156, 2, 45, "Section"],
Cell[145019, 3596, 2576, 55, 214, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[147632, 3656, 112, 1, 45, "Section"],
Cell[147747, 3659, 20654, 449, 1300, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[168438, 4113, 144, 2, 45, "Section"],
Cell[168585, 4117, 215, 5, 28, "Input"],
Cell[168803, 4124, 2075, 55, 143, "Input"],
Cell[170881, 4181, 2891, 76, 181, "Input"],
Cell[173775, 4259, 5220, 134, 333, "Input"],
Cell[178998, 4395, 2498, 69, 200, "Input"],
Cell[181499, 4466, 3704, 89, 257, "Input"],
Cell[185206, 4557, 2563, 69, 181, "Input"],
Cell[187772, 4628, 4705, 125, 219, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

